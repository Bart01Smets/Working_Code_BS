(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    167656,       3764]
NotebookOptionsPosition[    154702,       3553]
NotebookOutlinePosition[    155103,       3569]
CellTagsIndexPosition[    155060,       3566]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
  "directory", "=", 
   "\"\<C:/Users/Robert Shimer/Dropbox/Gregor-Maryam Disease \
Transmission/forgraphs\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.7984773623265715`*^9, 3.798477371618246*^9}, {
  3.801701308688469*^9, 3.8017013090462623`*^9}, {3.801701404023351*^9, 
  3.801701405102729*^9}, {3.8019311544767*^9, 3.8019311668050647`*^9}, {
  3.8025583884727364`*^9, 3.8025583891293592`*^9}, {3.8032513508204575`*^9, 
  3.803251352139711*^9}, {3.822757127706626*^9, 3.822757144416855*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"a110e90a-254c-4db9-8957-43d906283d74"],

Cell[CellGroupData[{

Cell["No Behavioral Change", "Subsubsection",
 CellChangeTimes->{{3.7955600631624956`*^9, 
  3.795560072978836*^9}},ExpressionUUID->"00873515-0fde-49f2-b8c4-\
c0e084765f5a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SIR", "[", 
  RowBox[{
   RowBox[{
    FractionBox["3", "10"], "+", 
    FractionBox["1", "7"]}], ",", 
   FractionBox["1", "7"], ",", 
   FractionBox["0.05", "365"], ",", 
   FractionBox["0.67", "365"], ",", "197", ",", "0.0000527", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7959742777136245`*^9, 3.7959743059904723`*^9}, {
   3.7959743601354847`*^9, 3.795974369663061*^9}, {3.795974405780372*^9, 
   3.7959744184391594`*^9}, {3.795974528926958*^9, 3.7959745299033966`*^9}, {
   3.7959747434172688`*^9, 3.7959747446385736`*^9}, {3.7960400826887264`*^9, 
   3.7960400876557355`*^9}, {3.79604013108529*^9, 3.79604013282386*^9}, {
   3.796040171922515*^9, 3.7960401730969954`*^9}, {3.796062265054158*^9, 
   3.79606227392908*^9}, {3.7960633558498735`*^9, 3.7960633643140297`*^9}, {
   3.7961188717377214`*^9, 3.796118871944602*^9}, 3.7977834342985325`*^9, {
   3.798482433679989*^9, 3.7984824342097034`*^9}, {3.7984824699342594`*^9, 
   3.798482473938943*^9}, {3.798482562261411*^9, 3.7984825641773167`*^9}, {
   3.8014946806105194`*^9, 3.8014946809423046`*^9}, 3.801584543098879*^9, {
   3.801821404029461*^9, 3.801821404404245*^9}, {3.8025169127327814`*^9, 
   3.8025169147079353`*^9}, 3.802523030449705*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"044e4977-fb8b-4062-9d16-a761e7b2415c"],

Cell[CellGroupData[{

Cell[BoxData["\<\"SIR_gamma0.143_beta0.443_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{
  3.798482481636538*^9, {3.7984825563107986`*^9, 3.7984825967156725`*^9}, 
   3.8014944897386007`*^9, {3.801494586338256*^9, 3.8014946358968725`*^9}, 
   3.8014946913603354`*^9, 3.801494869663889*^9, {3.801504251007631*^9, 
   3.8015042712200565`*^9}, 3.8015845851285458`*^9, 3.801821409361379*^9, 
   3.8024408961513615`*^9, 3.8024426807308292`*^9, {3.8024430707684546`*^9, 
   3.8024430994090185`*^9}, 3.802444185497339*^9, 3.802446099244978*^9, 
   3.8025169151769047`*^9, 3.802517980749284*^9, 3.802523035727657*^9, 
   3.803504999413369*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"eac7bbc9-84f7-4d91-bb95-23005881c1c8"],

Cell[BoxData["\<\"Health Cost and Total Cost: 172.541\"\>"], "Print",
 CellChangeTimes->{
  3.798482481636538*^9, {3.7984825563107986`*^9, 3.7984825967156725`*^9}, 
   3.8014944897386007`*^9, {3.801494586338256*^9, 3.8014946358968725`*^9}, 
   3.8014946913603354`*^9, 3.801494869663889*^9, {3.801504251007631*^9, 
   3.8015042712200565`*^9}, 3.8015845851285458`*^9, 3.801821409361379*^9, 
   3.8024408961513615`*^9, 3.8024426807308292`*^9, {3.8024430707684546`*^9, 
   3.8024430994090185`*^9}, 3.802444185497339*^9, 3.802446099244978*^9, 
   3.8025169151769047`*^9, 3.802517980749284*^9, 3.802523035727657*^9, 
   3.803504999720192*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"8500d305-5977-4b5e-a2ec-f4fe897aa5ca"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solve model", "Subsubsection",
 CellChangeTimes->{{3.795560092659489*^9, 3.7955600959385986`*^9}, {
  3.7955616739797783`*^9, 
  3.795561675443948*^9}},ExpressionUUID->"3dab064e-8cc9-4b10-b971-\
d809a3865e02"],

Cell[TextData[{
 "Input format: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"solution", "[", 
    RowBox[{
    "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", 
     "\[Rho]", ",", "\[Kappa]", ",", 
     RowBox[{
      SubscriptBox["N", "i"], "[", "0", "]"}], ",", 
     RowBox[{"Export", "\[Rule]", "\"\<directory\>\""}], ",", 
     RowBox[{"FX", "\[Rule]", "$ExchangeRate"}], ",", 
     RowBox[{"Debug", "\[Rule]", "False"}], ",", 
     RowBox[{"Utility", "\[Rule]", "Log"}]}], "]"}], TraditionalForm]],
  ExpressionUUID->"d23a4492-d18a-44b3-bf02-4c50a45b4f72"],
 "."
}], "Text",
 CellChangeTimes->{{3.798400857441312*^9, 3.798400948575195*^9}, {
  3.7984010506332417`*^9, 3.7984011426056447`*^9}, {3.7984126915305595`*^9, 
  3.7984127170218697`*^9}, {3.7984128830173283`*^9, 3.7984128830173283`*^9}, {
  3.802100262046658*^9, 3.8021002763394613`*^9}, {3.803250579625316*^9, 
  3.8032506003533325`*^9}, {3.8032509923197346`*^9, 3.8032509923197346`*^9}, {
  3.8032512497089148`*^9, 3.8032512520225773`*^9}, {3.8032515480592594`*^9, 
  3.8032515546514487`*^9}},ExpressionUUID->"d58cc137-4b6e-4892-b703-\
0003c883b322"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]", "=", 
   RowBox[{
    FractionBox["3", "10"], "+", 
    FractionBox["1", "7"]}]}], ";", 
  RowBox[{"\[Gamma]", "=", 
   FractionBox["1", "7"]}], ";", 
  RowBox[{"\[Delta]", "=", 
   FractionBox["0.67", "365"]}], ";", 
  RowBox[{"\[Rho]", "=", 
   FractionBox["0.05", "365"]}], ";", 
  RowBox[{"\[Kappa]", "=", "197"}], ";", 
  RowBox[{"ni0", "=", "0.0000527"}], ";", 
  RowBox[{"fx", "=", "123"}], ";"}]], "Input",
 CellChangeTimes->{{3.803251018751459*^9, 3.803251032908256*^9}, {
  3.8032510777433662`*^9, 3.8032511035094385`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"90b8af57-805f-4dd1-9a38-11f097ab252e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "0", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", 
   RowBox[{"Debug", "\[Rule]", "True"}], ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8032511104394307`*^9, 3.803251131183442*^9}, 
   3.803251297712179*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"bfbcf700-2b87-4f5d-b147-6388d8a06aa8"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha0_gamma0.143_beta0.443_kappa197_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{
  3.803251144897509*^9, 3.803251217321638*^9, 3.8032513821183624`*^9, {
   3.8227579415998683`*^9, 3.8227579694578876`*^9}},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"7ccf532b-07ec-4128-9889-50cfadae8526"],

Cell[BoxData["\<\"Health Cost: 11374\"\>"], "Print",
 CellChangeTimes->{
  3.803251144897509*^9, 3.803251217321638*^9, 3.8032513821183624`*^9, {
   3.8227579415998683`*^9, 3.822757969464884*^9}},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"4c844d5f-1512-4e15-a5e7-2b24e92050e1"],

Cell[BoxData["\<\"Activity Cost: 1277\"\>"], "Print",
 CellChangeTimes->{
  3.803251144897509*^9, 3.803251217321638*^9, 3.8032513821183624`*^9, {
   3.8227579415998683`*^9, 3.822757969476877*^9}},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"56661554-f734-453d-bd8a-9bf5a29a325d"],

Cell[BoxData["\<\"Total Cost: 12652\"\>"], "Print",
 CellChangeTimes->{
  3.803251144897509*^9, 3.803251217321638*^9, 3.8032513821183624`*^9, {
   3.8227579415998683`*^9, 3.8227579694798727`*^9}},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"58f2982f-5d98-40ae-9b0d-a259e6524bb8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "1", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.803251230965754*^9, 3.8032512310077443`*^9}, 
   3.8032513018627744`*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"89e1f019-6f13-48ae-a92c-bef431070cc5"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha1_gamma0.143_beta0.443_kappa197_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"c673e145-bc98-487b-97df-01337e5d4294"],

Cell[BoxData["\<\"Health Cost: 860\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434953886*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"a8a79808-0a29-4b14-b1fc-28cb005a16dd"],

Cell[BoxData["\<\"Activity Cost: 7227\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.80325143496388*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"c1c8cc46-8505-42e4-958f-4108fdb6d2c8"],

Cell[BoxData["\<\"Total Cost: 8087\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.8032514349668784`*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"f0c2609b-d297-444b-a838-594ccedec281"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "0.5", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",",
    "\[Kappa]", ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8032519269761934`*^9, 3.8032519273779616`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"9e281195-ff26-47aa-b047-fc2ba4d1c628"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha0.5_gamma0.143_beta0.443_kappa197_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.8032519868845577`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"1afdce80-a85e-45e6-8b7e-9f649855aa9f"],

Cell[BoxData["\<\"Health Cost: 8059\"\>"], "Print",
 CellChangeTimes->{3.8032519868885555`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"5916c168-37fe-4e28-85c4-502c9b245011"],

Cell[BoxData["\<\"Activity Cost: 2582\"\>"], "Print",
 CellChangeTimes->{3.80325198689655*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"be83adcc-865c-46a6-a4c5-0c45ac6dd6d8"],

Cell[BoxData["\<\"Total Cost: 10641\"\>"], "Print",
 CellChangeTimes->{3.8032519868995485`*^9},
 CellLabel->
  "During evaluation of \
In[29]:=",ExpressionUUID->"74da0d6d-c3c1-453c-82b2-d4d2ac906c24"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "0", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}], ",", 
   RowBox[{"Utility", "\[Rule]", "\"\<Quadratic\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8032515400388966`*^9, 3.803251568864259*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"1135963b-5369-41a9-9ec2-aec6704b2004"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"5.104617543507696`*^302\\\"}]\\), step size is effectively zero; \
singularity or stiff system suspected.\"", 2, 13, 1, 23371938399300279445, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515730747976`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"38b6e2d5-e24f-401d-8876-773f84495269"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"1.2302314000616043`*^302\\\"}]\\), step size is effectively zero; \
singularity or stiff system suspected.\"", 2, 13, 2, 23371938399300279445, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515732267094`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"62d6ed22-2d10-4897-aa40-958ba2f8f4ad"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"1.1018908773872128`*^302\\\"}]\\), step size is effectively zero; \
singularity or stiff system suspected.\"", 2, 13, 3, 23371938399300279445, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515732357044`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"19d760fa-015e-4db0-8e55-574687b8bf50"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NDSolve\\\", \
\\\"::\\\", \\\"ndsz\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 13, 4, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515732436996`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"f4fd442b-6bcd-413c-bb85-3e86417ec3a0"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Quadratic_alpha0_gamma0.143_beta0.443_kappa197_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.8032515749587083`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"8f2b5b59-edd2-4b9d-962f-b4b7489dcaac"],

Cell[BoxData["\<\"Health Cost: 9948\"\>"], "Print",
 CellChangeTimes->{3.8032515749607067`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"54faf1a9-9e90-4ad7-87b6-d10c601b6510"],

Cell[BoxData["\<\"Activity Cost: 1435\"\>"], "Print",
 CellChangeTimes->{3.803251574971717*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"cfeea2c7-18e6-4bcf-89cf-d8bd82760d99"],

Cell[BoxData["\<\"Total Cost: 11384\"\>"], "Print",
 CellChangeTimes->{3.803251574974699*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"5125a3a9-9a6f-4e33-ac7a-0c436c13dee4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "1", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}], ",", 
   RowBox[{"Utility", "\[Rule]", "\"\<Quadratic\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{3.8032515822824883`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"ff881c31-b6f1-46dd-b50c-3031b0f7b899"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", \\\"4.778757349996649`*^307\\\"]\\) is \
too small to represent as a normalized machine number; precision may be lost.\
\"", 2, 14, 5, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515828871245`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"ab498f2f-a3da-48df-ab90-829bfe6de134"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", \\\"5.669738285937827`*^307\\\"]\\) is \
too small to represent as a normalized machine number; precision may be lost.\
\"", 2, 14, 6, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.803251582899126*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"143f95a8-04b4-4617-9187-971e402223b6"],

Cell[BoxData[
 TemplateBox[{
  "General", "munfl", 
   "\"\\!\\(\\*FractionBox[\\\"1\\\", \\\"6.726839161708897`*^307\\\"]\\) is \
too small to represent as a normalized machine number; precision may be lost.\
\"", 2, 14, 7, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515829081125`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"83daa998-f3fb-4d5f-a05e-b8b04555d8b2"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"", 2, 14, 8, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515830160503`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"55aead1c-afbc-4aae-a43d-c20d21cbac4e"],

Cell[BoxData[
 TemplateBox[{
  "RowReduce", "luc", 
   "\"Result for \\!\\(\\*RowBox[{\\\"RowReduce\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.1899072270303668`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"2709.380785638596`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"3.0528223461072766`*^-22\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"9.476803066183367`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"3.276398891372958`\\\"}], \\\",\\\", \\\"1.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\
\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"2.552787675036564`15.954589770191005*^323\
\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"1.760733546731204`\\\"}], \\\",\\\", \
\\\"1.1899072270303668`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", RowBox[{\\\"-\\\", \\\"1.257421337028406`*^-6\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"4.57639694483385`15.954589770191005*^646\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"1.334761910596657`15.954589770191005*^324\\\
\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.9999995536564346`\\\", \\\",\\\
\", \\\"13.943109630930257`\\\", \\\",\\\", \
\\\"4.471989556929622`15.954589770191005*^316\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.845319442726283`15.954589770191005*^324\\\"}], \\\",\\\", \
\\\"59.564128848842245`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"1.1899072270303668`\\\", \\\",\\\", \
\\\"2.5148426503642737`*^-6\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) may contain \
significant numerical errors.\"", 2, 14, 9, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.803251583024045*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"ea261ec9-ffab-4d6e-acf6-bd46ce5bf5f9"],

Cell[BoxData[
 TemplateBox[{
  "RowReduce", "luc", 
   "\"Result for \\!\\(\\*RowBox[{\\\"RowReduce\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.1899072270303668`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"2709.380785638596`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"4.318252124563296`*^-22\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"9.476803066183367`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"3.276398891372958`\\\"}], \\\",\\\", \\\"1.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\
\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"2.552787675036564`15.954589770191005*^323\
\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"1.760733546731204`\\\"}], \\\",\\\", \
\\\"1.1899072270303668`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", RowBox[{\\\"-\\\", \\\"4.804669135707192`*^-6\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"4.57639694483385`15.954589770191005*^646\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"1.334761910596657`15.954589770191005*^324\\\
\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.9999995536564346`\\\", \\\",\\\
\", \\\"13.943109630930257`\\\", \\\",\\\", \
\\\"1.331896256241321`15.954589770191005*^317\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.845319442726283`15.954589770191005*^324\\\"}], \\\",\\\", \
\\\"59.564128848842245`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"1.1899072270303668`\\\", \\\",\\\", \\\"9.609338186248983`*^-6\
\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) may contain significant numerical \
errors.\"", 2, 14, 10, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.80325158303304*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"75fb44a7-2c70-4701-99d3-f5674c7e2c99"],

Cell[BoxData[
 TemplateBox[{
  "RowReduce", "luc", 
   "\"Result for \\!\\(\\*RowBox[{\\\"RowReduce\\\"}]\\) of badly conditioned \
matrix \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"1.1899072270303668`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"2709.380785638596`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \
\\\"3.7578014982729482`*^-22\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"9.476803066183367`\\\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\"}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"3.276398891372958`\\\"}], \\\",\\\", \\\"1.`\\\", \
\\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \\\",\
\\\", \\\"0.`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.`\\\", \\\",\\\", \\\"2.552787675036564`15.954589770191005*^323\
\\\", \\\",\\\", RowBox[{\\\"-\\\", \\\"1.760733546731204`\\\"}], \\\",\\\", \
\\\"1.1899072270303668`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", RowBox[{\\\"-\\\", \\\"0.000011820013665836795`\\\"}]}], \
\\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", \
RowBox[{\\\"-\\\", \\\"4.57639694483385`15.954589770191005*^646\\\"}], \
\\\",\\\", RowBox[{\\\"-\\\", \\\"1.334761910596657`15.954589770191005*^324\\\
\"}], \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.9999995536564346`\\\", \\\",\\\
\", \\\"13.943109630930257`\\\", \\\",\\\", \
\\\"2.942696633833938`15.954589770191005*^317\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.`\\\", \\\",\\\", RowBox[{\\\"-\\\", \
\\\"1.845319442726283`15.954589770191005*^324\\\"}], \\\",\\\", \
\\\"59.564128848842245`\\\", \\\",\\\", \\\"0.`\\\", \\\",\\\", \\\"0.`\\\", \
\\\",\\\", \\\"1.1899072270303668`\\\", \\\",\\\", \
\\\"0.000023640027131946115`\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) may contain \
significant numerical errors.\"", 2, 14, 11, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.803251583043034*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"b0a689f1-227c-4af1-82ea-41130ebbaf51"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"RowReduce\\\", \\\"::\\\
\", \\\"luc\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 14, 12, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515830520287`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"dedcfd27-f66b-476e-8cb0-61d34603fcab"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"2.549644100667076`*^8\\\"}]\\), step size is effectively zero; \
singularity or stiff system suspected.\"", 2, 14, 13, 23371938399300279445, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515837366457`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"0bdfe3d8-e093-4ba0-bab2-77d12004130e"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndcf", 
   "\"Repeated convergence test failure at \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \
\\!\\(\\*RowBox[{\\\"-\\\", \\\"43568.939356539326`\\\"}]\\); unable to \
continue.\"", 2, 14, 14, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.803251583913531*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"f82f1597-3858-4956-afa2-ff35812b857b"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"100150.13090281829`\\\"}]\\), step size is effectively zero; singularity \
or stiff system suspected.\"", 2, 14, 15, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515840494523`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"b06d3021-7f32-49b6-ada7-c472ce760dd0"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndcf", 
   "\"Repeated convergence test failure at \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \
\\!\\(\\*RowBox[{\\\"-\\\", \\\"1.2263575963764336`*^31\\\"}]\\); unable to \
continue.\"", 2, 14, 16, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515853347096`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"1dffa416-d04e-420b-a076-35d0c43fd1a8"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"7.158995693899987`*^34\\\"}]\\), step size is effectively zero; \
singularity or stiff system suspected.\"", 2, 14, 17, 23371938399300279445, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515854366503`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"9cf82ade-8d96-4e37-99f5-f8eea087d639"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NDSolve\\\", \
\\\"::\\\", \\\"ndsz\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 14, 18, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.803251585444646*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"90ac620b-c22a-4d34-af75-02d14fab915a"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndcf", 
   "\"Repeated convergence test failure at \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \
\\!\\(\\*RowBox[{\\\"-\\\", \\\"2.8131734209072363`*^34\\\"}]\\); unable to \
continue.\"", 2, 14, 19, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.803251585453641*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"e56aafdf-e4e5-4d09-a173-d414de72ce31"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NDSolve\\\", \
\\\"::\\\", \\\"ndcf\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 14, 20, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032515854626355`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"6032f2da-b4d0-4e40-b05a-13b06dad1b33"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Quadratic_alpha1_gamma0.143_beta0.443_kappa197_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251625740349*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"e796c820-da15-4482-884d-fdd4cbe6846d"],

Cell[BoxData["\<\"Health Cost: 214\"\>"], "Print",
 CellChangeTimes->{3.8032516257423477`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"c5f7532d-9468-41b3-b158-4178c893f670"],

Cell[BoxData["\<\"Activity Cost: 5616\"\>"], "Print",
 CellChangeTimes->{3.8032516257503433`*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"c98f9a8b-f718-4e7a-ac08-3aabac928012"],

Cell[BoxData["\<\"Total Cost: 5830\"\>"], "Print",
 CellChangeTimes->{3.803251625752342*^9},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"0aa9728e-039b-4e08-b2ad-e7899daf5667"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "0", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   RowBox[{"0.5", " ", "\[Kappa]"}], ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8032511104394307`*^9, 3.803251131183442*^9}, 
   3.803251297712179*^9, {3.803251605563015*^9, 3.803251611441633*^9}, {
   3.8032516852269583`*^9, 3.8032516867460794`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"3e283dc0-d862-4b3f-9450-91971f1bec80"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha0_gamma0.143_beta0.443_kappa98.5_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.803251630106825*^9, 3.803251695427061*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"a2ae016a-cbea-4479-9a36-9937535e422c"],

Cell[BoxData["\<\"Health Cost: 6763\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.803251630106825*^9, 3.8032516954300585`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"fedec983-12a7-41ea-aec9-77f3e222225c"],

Cell[BoxData["\<\"Activity Cost: 611\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.803251630106825*^9, 3.8032516954390535`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"7050a73c-7fb9-42b4-bdeb-1c6d9ffc0933"],

Cell[BoxData["\<\"Total Cost: 7373\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.803251630106825*^9, 3.8032516954410524`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"ba4b871e-c43f-4e3c-b947-2c5f762171a1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "1", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   RowBox[{"0.5", " ", "\[Kappa]"}], ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.803251230965754*^9, 3.8032512310077443`*^9}, 
   3.8032513018627744`*^9, {3.803251613435463*^9, 3.803251613802251*^9}, {
   3.8032516894924917`*^9, 3.803251690322012*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"ad4525af-6eb5-4edd-8666-31fdb15aa6f2"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha1_gamma0.143_beta0.443_kappa98.5_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516549364696`*^9, 3.803251719181328*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"c44dc0ad-9507-400b-9c3e-f46c63f4d521"],

Cell[BoxData["\<\"Health Cost: 3942\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516549364696`*^9, 3.803251719184325*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"7e7b31a1-5cba-40ae-ac3c-7fff26a61e1a"],

Cell[BoxData["\<\"Activity Cost: 2358\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516549364696`*^9, 3.8032517191953187`*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"710c75df-64d8-4a16-8296-eb7859641992"],

Cell[BoxData["\<\"Total Cost: 6300\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516549364696`*^9, 3.803251719197318*^9},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"326810e0-d30b-4a01-b197-78ae624a55da"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{"0", ",", 
   RowBox[{
    FractionBox["3", "10"], "+", 
    FractionBox["1", "18"]}], ",", 
   FractionBox["1", "18"], ",", "\[Delta]", ",", "\[Rho]", ",", "\[Kappa]", 
   ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8032511104394307`*^9, 3.803251131183442*^9}, 
   3.803251297712179*^9, {3.803251605563015*^9, 3.803251639113618*^9}, {
   3.8032518919544535`*^9, 3.803251893360627*^9}, 3.803253617321163*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"0c2e0dc5-8429-4d0d-acb6-28ce68166b3b"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"513.3902386172866`\\\"}]\\), step size is effectively zero; singularity \
or stiff system suspected.\"", 2, 27, 27, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032516552462907`*^9, 3.80325173235571*^9, 
  3.803251896084053*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"47f51b04-e8bf-4225-9e23-38ea416ebca5"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"1265.4417763237193`\\\"}]\\), step size is effectively zero; singularity \
or stiff system suspected.\"", 2, 27, 28, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032516552462907`*^9, 3.80325173235571*^9, 
  3.8032518963299103`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"eacfb06f-7178-4803-b8f9-f1629970aff6"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"1769.0403840500132`\\\"}]\\), step size is effectively zero; singularity \
or stiff system suspected.\"", 2, 27, 29, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032516552462907`*^9, 3.80325173235571*^9, 
  3.803251896669714*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"b77442c6-4231-4580-983f-1a4c61f6a8d3"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NDSolve\\\", \
\\\"::\\\", \\\"ndsz\\\"}], \\\"MessageName\\\"]\\) will be suppressed during \
this calculation.\"", 2, 27, 30, 23371938399300279445, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.8032516552462907`*^9, 3.80325173235571*^9, 
  3.803251896764659*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"0fba1919-eba5-4437-b304-0dda76d96c16"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha0_gamma0.0556_beta0.356_kappa197_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032516596767483`*^9, 3.803251736664233*^9, 
  3.803251899959812*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"7d2e17d2-ce05-41dd-b91d-27d704049f4b"],

Cell[BoxData["\<\"Health Cost: 15973\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032516596767483`*^9, 3.803251736664233*^9, 
  3.803251899961811*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"7ae769cd-8de8-441f-a516-aae0fe7a527b"],

Cell[BoxData["\<\"Activity Cost: 1799\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032516596767483`*^9, 3.803251736664233*^9, 
  3.8032518999698057`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"dc27c004-4a3b-440f-adbe-8b30005d23ca"],

Cell[BoxData["\<\"Total Cost: 17772\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032516596767483`*^9, 3.803251736664233*^9, 
  3.8032518999718046`*^9},
 CellLabel->
  "During evaluation of \
In[27]:=",ExpressionUUID->"3eb2f990-2624-4247-8c03-7b81527e0adf"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{"1", ",", 
   RowBox[{
    FractionBox["3", "10"], "+", 
    FractionBox["1", "18"]}], ",", 
   FractionBox["1", "18"], ",", "\[Delta]", ",", "\[Rho]", ",", "\[Kappa]", 
   ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.803251230965754*^9, 3.8032512310077443`*^9}, 
   3.8032513018627744`*^9, {3.8032516435630627`*^9, 3.8032516474018445`*^9}, {
   3.8032518986505685`*^9, 3.803251899504075*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"4a324742-b532-4af7-bc84-03b92c179454"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha1_gamma0.0556_beta0.356_kappa197_delta0.\
00183562_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516741683645`*^9, 3.8032517511728454`*^9, 3.803251912204733*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"1d9b3866-7c49-4715-a464-b6e58c98069f"],

Cell[BoxData["\<\"Health Cost: 8776\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516741683645`*^9, 3.8032517511728454`*^9, 3.8032519122087297`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"9734b6e9-78c8-4668-a55d-8d285d4c9224"],

Cell[BoxData["\<\"Activity Cost: 6630\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516741683645`*^9, 3.8032517511728454`*^9, 3.8032519122167263`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"a0be62c4-8d05-48dc-bee7-e0c0857d85ad"],

Cell[BoxData["\<\"Total Cost: 15406\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032516741683645`*^9, 3.8032517511728454`*^9, 3.8032519122187243`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"fb64ba7b-4042-4e7b-a1ea-f504c54ad490"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{"0", ",", "\[Beta]", ",", "\[Gamma]", ",", 
   FractionBox["0.33", "365"], ",", "\[Rho]", ",", "\[Kappa]", ",", "ni0", 
   ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8032511104394307`*^9, 3.803251131183442*^9}, 
   3.803251297712179*^9, 3.803251605563015*^9, {3.803251745481122*^9, 
   3.8032517475209436`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"38a24ca0-7313-4072-86d4-9f1c4a80abac"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha0_gamma0.143_beta0.443_kappa197_delta0.\
00090411_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032517577160563`*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"2b781160-fa0e-483d-b146-2ac613640ec3"],

Cell[BoxData["\<\"Health Cost: 13541\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032517577190466`*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"5e432195-90ff-4083-b144-40479d101676"],

Cell[BoxData["\<\"Activity Cost: 1293\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.803251757729059*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"bdc3665d-e86a-4776-afaa-72f26584a919"],

Cell[BoxData["\<\"Total Cost: 14834\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.803251757731057*^9},
 CellLabel->
  "During evaluation of \
In[23]:=",ExpressionUUID->"f273c743-2110-4f6f-84f6-3aea1014a415"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{"1", ",", "\[Beta]", ",", "\[Gamma]", ",", 
   FractionBox["0.33", "365"], ",", "\[Rho]", ",", "\[Kappa]", ",", "ni0", 
   ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.803251230965754*^9, 3.8032512310077443`*^9}, 
   3.8032513018627744`*^9, {3.8032517518184586`*^9, 3.80325175396122*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"8049e2cb-2d70-4fbb-929d-1def797f80ac"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha1_gamma0.143_beta0.443_kappa197_delta0.\
00090411_Ni0.0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.803251818850704*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"1f2ea569-be87-4b3f-bfc8-5bf3f1775614"],

Cell[BoxData["\<\"Health Cost: 7883\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032518188537025`*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"8f595c67-df56-443b-b234-ea754530a754"],

Cell[BoxData["\<\"Activity Cost: 4735\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.803251818861698*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"cda87316-fdac-48f9-841e-2ca7d66f8712"],

Cell[BoxData["\<\"Total Cost: 12618\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.803251818863702*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"30ff2ecb-fbde-4b74-9221-53649f62f655"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "0", ",", "\[Beta]", ",", "\[Gamma]", ",", "0", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{3.830516619809805*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"6e449b45-9448-4911-8ed0-e9c732be08ae"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha0_gamma0.143_beta0.443_kappa197_delta0_Ni0.\
0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.830516628090436*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"dcfbc948-2833-4a83-8f3f-abae91f4393f"],

Cell[BoxData["\<\"Health Cost: 16127\"\>"], "Print",
 CellChangeTimes->{3.830516628095434*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"7fbdbd08-620b-4c3b-a5ee-4e7bd871425a"],

Cell[BoxData["\<\"Activity Cost: 1238\"\>"], "Print",
 CellChangeTimes->{3.8305166281054277`*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"fde236d2-6cfc-45cf-93db-12fa33aef990"],

Cell[BoxData["\<\"Total Cost: 17365\"\>"], "Print",
 CellChangeTimes->{3.8305166281074266`*^9},
 CellLabel->
  "During evaluation of \
In[12]:=",ExpressionUUID->"3ffd2038-e0d9-49ff-b73c-2770ccd69639"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "1", ",", "\[Beta]", ",", "\[Gamma]", ",", "0", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{3.830516637998228*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"2bdf40ea-14b1-4d1e-bdce-45db7207b537"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha1_gamma0.143_beta0.443_kappa197_delta0_Ni0.\
0000527.dat\"\>"], "Print",
 CellChangeTimes->{3.830516746144394*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"bce01bb1-157f-41de-9c9d-706907c189be"],

Cell[BoxData["\<\"Health Cost: 15556\"\>"], "Print",
 CellChangeTimes->{3.8305167461483927`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"a460bf64-78b6-43da-9afb-5b2ee45c4e41"],

Cell[BoxData["\<\"Activity Cost: 713\"\>"], "Print",
 CellChangeTimes->{3.830516746157386*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"396fa945-0956-419b-a1e5-1171f4f625f7"],

Cell[BoxData["\<\"Total Cost: 16269\"\>"], "Print",
 CellChangeTimes->{3.830516746162383*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"81d715ff-f1eb-412b-adbb-3dc2d296a46c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "0", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "0.01", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.8032511104394307`*^9, 3.803251131183442*^9}, 
   3.803251297712179*^9, 3.803251605563015*^9, {3.8032517790087385`*^9, 
   3.8032517795054517`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"e02c42a8-3203-4c09-a2db-bcb6b259f104"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha0_gamma0.143_beta0.443_kappa197_delta0.\
00183562_Ni0.01.dat\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.803251825519849*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"584e0ddc-230f-44fe-92f1-e9d092415263"],

Cell[BoxData["\<\"Health Cost: 11745\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032518255238457`*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"6293615f-9ec9-48cf-ad9f-3a4474c4d328"],

Cell[BoxData["\<\"Activity Cost: 1327\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.8032518255328407`*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"42f9bf93-c260-4f6f-ab0f-8874c87d6bbc"],

Cell[BoxData["\<\"Total Cost: 13072\"\>"], "Print",
 CellChangeTimes->{3.803251144897509*^9, 3.803251217321638*^9, 
  3.8032513821183624`*^9, 3.80325182553484*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"3d7c91e2-23c9-4894-885d-7f0f883a7d99"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", "[", 
  RowBox[{
  "1", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "0.01", ",", 
   RowBox[{"Export", "\[Rule]", "directory"}], ",", 
   RowBox[{"FX", "\[Rule]", "fx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.803251230965754*^9, 3.8032512310077443`*^9}, 
   3.8032513018627744`*^9, {3.803251783985862*^9, 3.8032517844735794`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"da89bc2a-30a4-4526-b27c-6158243bfba9"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Results_alpha1_gamma0.143_beta0.443_kappa197_delta0.\
00183562_Ni0.01.dat\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032518767982025`*^9},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"abe8b99f-28d1-420b-8194-d86349daf0a1"],

Cell[BoxData["\<\"Health Cost: 1852\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.803251876801201*^9},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"6c87e416-d10d-48c6-941a-bbd97b1beac8"],

Cell[BoxData["\<\"Activity Cost: 7164\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.803251876809196*^9},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"e1d2dfff-7200-492e-af9b-d06ace3cccae"],

Cell[BoxData["\<\"Total Cost: 9016\"\>"], "Print",
 CellChangeTimes->{3.803251280670014*^9, 3.803251434949888*^9, 
  3.8032518768111954`*^9},
 CellLabel->
  "During evaluation of \
In[26]:=",ExpressionUUID->"32234931-91b2-4963-90b7-095f0ccd28a4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"shock", "[", 
  RowBox[{
  "0", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", "210", ",", "20", ",", "1.5", ",", 
   RowBox[{"FX", "\[Rule]", "fx"}], ",", 
   RowBox[{"Export", "\[Rule]", "directory"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.822754414036435*^9, 3.822754432158044*^9}, 
   3.8227544734643908`*^9, {3.822754576300434*^9, 3.8227545785271587`*^9}, {
   3.822754703014806*^9, 3.8227547245054874`*^9}, {3.822755163070219*^9, 
   3.8227551833795795`*^9}, 3.8227570841266055`*^9, {3.8227584573366613`*^9, 
   3.822758506574643*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"ad26dd2d-4b91-4382-b36f-cdfb9f135797"],

Cell[BoxData[
 TemplateBox[{
  "NDSolve", "ndsz", 
   "\"At \\!\\(\\*RowBox[{\\\"t\\\"}]\\) == \\!\\(\\*RowBox[{\\\"-\\\", \
\\\"837.844178706834`\\\"}]\\), step size is effectively zero; singularity or \
stiff system suspected.\"", 2, 17, 24, 21110653519802202611, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8227544338910522`*^9, 3.8227544742349277`*^9, 3.8227545857300234`*^9, {
   3.8227547107253847`*^9, 3.8227547320741653`*^9}, 3.822754823799582*^9, 
   3.8227550229394946`*^9, {3.8227551701471562`*^9, 3.822755191080166*^9}, 
   3.822757167499177*^9, 3.82275731171352*^9, 3.8227573686259017`*^9, 
   3.8227574850985107`*^9, 3.822757793077467*^9, 3.822757981845788*^9, {
   3.8227584655448103`*^9, 3.82275851449559*^9}},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"cc77435d-7af1-4a98-a9eb-947f6970e39d"],

Cell[BoxData["\<\"Shock_alpha0_gamma0.143_beta0.443_kappa197_delta0.00183562_\
Ni0.0000527_T1210_T220_z1.5.dat\"\>"], "Print",
 CellChangeTimes->{3.8227585207022133`*^9},
 CellLabel->
  "During evaluation of \
In[17]:=",ExpressionUUID->"75158a0b-3c65-4a4b-9368-81a88f75f4c0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"shock", "[", 
  RowBox[{
  "1", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", "\[Rho]", ",", 
   "\[Kappa]", ",", "ni0", ",", "210", ",", "20", ",", "1.5", ",", 
   RowBox[{"FX", "\[Rule]", "fx"}], ",", 
   RowBox[{"Export", "\[Rule]", "directory"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.8227579897042856`*^9, {3.8227584608749332`*^9, 3.8227584610698223`*^9}, 
   3.8227584933414855`*^9, {3.8227585402549906`*^9, 3.8227585416717544`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"e7231f87-b7e0-4a37-85cb-3b79b6258ed4"],

Cell[BoxData["\<\"Shock_alpha1_gamma0.143_beta0.443_kappa197_delta0.00183562_\
Ni0.0000527_T1210_T220_z1.5.dat\"\>"], "Print",
 CellChangeTimes->{3.8227581048004107`*^9, 3.8227586643950276`*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"179855c5-3a60-4ace-b4f4-a00dfa73fe26"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define functions", "Subsubsection",
 CellChangeTimes->{{3.795560076330904*^9, 
  3.795560078610593*^9}},ExpressionUUID->"54a05d4d-b26c-4b1b-9d87-\
f9c5086b81a8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"NDSolve", "::", "evcvmit"}], "]"}], ";", 
  RowBox[{"Off", "[", 
   RowBox[{"NDSolve", "::", "mxst"}], "]"}], ";", 
  RowBox[{"Off", "[", 
   RowBox[{"InterpolatingFunction", "::", "dmval"}], "]"}], ";", 
  RowBox[{"Off", "[", 
   RowBox[{"FindRoot", "::", "lstol"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "SIR", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Export\>\"", "\[Rule]", "\"\<False\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SIR", "[", 
    RowBox[{
    "\[Beta]0_", ",", "\[Gamma]0_", ",", "\[Delta]0_", ",", "\[Rho]0_", ",", 
     "\[Kappa]0_", ",", "ni00_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Beta]", "=", "\[Beta]0"}], ",", 
       RowBox[{"\[Gamma]", "=", "\[Gamma]0"}], ",", 
       RowBox[{"ni0", "=", "ni00"}], ",", 
       RowBox[{"\[Rho]", "=", "\[Rho]0"}], ",", 
       RowBox[{"\[Delta]", "=", "\[Delta]0"}], ",", 
       RowBox[{"\[Kappa]", "=", "\[Kappa]0"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"Clear", "[", "nr0", "]"}], ";", 
      RowBox[{"nr0", "=", 
       RowBox[{"nr0", "/.", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{"ni0", "\[Equal]", 
           RowBox[{"1", "-", "nr0", "-", 
            RowBox[{"Exp", "[", 
             RowBox[{
              FractionBox[
               RowBox[{"-", "\[Beta]"}], "\[Gamma]"], "nr0"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"nr0", ",", 
            FractionBox["ni0", 
             RowBox[{
              FractionBox["\[Beta]", "\[Gamma]"], "-", "0.99"}]]}], "}"}]}], 
         "]"}]}]}], ";", 
      RowBox[{"ns0", "=", 
       RowBox[{"1", "-", "ni0", "-", "nr0"}]}], ";", 
      RowBox[{"temp", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ns", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"-", "\[Beta]"}], 
              RowBox[{"ns", "[", "t", "]"}], 
              RowBox[{"ni", "[", "t", "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"ni", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"\[Beta]", 
               RowBox[{"ns", "[", "t", "]"}], 
               RowBox[{"ni", "[", "t", "]"}]}], "-", 
              RowBox[{"\[Gamma]", 
               RowBox[{"ni", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"ns", "[", "0", "]"}], "\[Equal]", "ns0"}], ",", 
            RowBox[{
             RowBox[{"ni", "[", "0", "]"}], "\[Equal]", "ni0"}], ",", 
            RowBox[{"WhenEvent", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ni", "[", "t", "]"}], "<", "nifinal"}], ",", 
              "\"\<StopIntegration\>\""}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "ni"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", 
            SuperscriptBox["10", "6"]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "\[NotEqual]", 
         "\"\<False\>\""}], ",", 
        RowBox[{
         RowBox[{"SetDirectory", "[", 
          RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "]"}], ";", 
         RowBox[{"Print", "[", 
          RowBox[{"Export", "[", 
           RowBox[{
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<SIR_gamma\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{"\[Gamma]", ",", "3"}], "]"}], "]"}], ",", 
              "\"\<_beta\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"N", "[", 
                RowBox[{"\[Beta]", ",", "3"}], "]"}], "]"}], ",", 
              "\"\<_Ni\>\"", ",", 
              RowBox[{"ToString", "[", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "[", "ni0", "]"}], ",", 
                 RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], "]"}], 
              ",", "\"\<.dat\>\""}], "]"}], ",", 
            RowBox[{"N", "[", 
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "10"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"328000000", "0.0062", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"ns", "[", "t", "]"}], "-", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}]}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "9"}], "}"}]}]}], "]"}], ",", 
                    "1", ",", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    FractionBox["\[Beta]", "\[Gamma]"], 
                    RowBox[{"ns", "[", "t", "]"}]}], "]"}]}], "}"}], "/.", 
                    "temp"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", "0", ",", "200"}], "}"}]}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"730", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ns", "[", "200", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ni", "[", "200", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "10"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"328000000", "0.0062", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"ns", "[", "200", "]"}], "-", 
                    RowBox[{"ni", "[", "200", "]"}]}], ")"}]}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "9"}], "}"}]}]}], "]"}], ",", 
                    "1", ",", 
                    RowBox[{"N", "[", 
                    RowBox[{
                    FractionBox["\[Beta]", "\[Gamma]"], 
                    RowBox[{"ns", "[", "200", "]"}]}], "]"}]}], "}"}], "/.", 
                  "temp"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                "t", ",", "Ns", ",", "Ni", ",", "\"\<Dead_pi_0.0062\>\"", ",",
                  "A", ",", "Rt"}], "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<Health Cost and Total Cost: \>\"", ",", 
         RowBox[{"ToString", "[", 
          RowBox[{"NIntegrate", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"\[Rho]", "+", "\[Delta]"}], ")"}]}], "t"}], "]"}], 
              "\[Gamma]", "\[Kappa]", 
              RowBox[{"ni", "[", "t", "]"}]}], "/.", "temp"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", 
              RowBox[{"temp", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "2"}], "]"}], 
               "]"}]}], "}"}]}], "]"}], "]"}]}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.795525572273236*^9, {3.7955256219978523`*^9, 3.7955256605018606`*^9}, {
   3.795525813682347*^9, 3.795525878291442*^9}, {3.795526128647099*^9, 
   3.7955263272839456`*^9}, {3.7955263974189105`*^9, 3.795526404911605*^9}, 
   3.7955266111668267`*^9, {3.79554230633814*^9, 3.795542362683939*^9}, {
   3.7955562861651564`*^9, 3.795556327421357*^9}, {3.7959740814838705`*^9, 
   3.7959742532676353`*^9}, {3.795974311696188*^9, 3.795974393964159*^9}, {
   3.795974511330017*^9, 3.795974537289181*^9}, 3.7960401279053307`*^9, {
   3.796040165174526*^9, 3.796040186161332*^9}, {3.7960621739622974`*^9, 
   3.7960621859474335`*^9}, {3.796062532227214*^9, 3.796062537149396*^9}, {
   3.798415493082224*^9, 3.7984155111298323`*^9}, {3.7984823477691584`*^9, 
   3.798482368454341*^9}, {3.7984824117565365`*^9, 3.798482426850913*^9}, {
   3.7984825480275373`*^9, 3.798482589039065*^9}, {3.8014944083522162`*^9, 
   3.8014944736348352`*^9}, {3.8014945442423954`*^9, 
   3.8014946205166817`*^9}, {3.802442650729046*^9, 3.8024426700049925`*^9}, {
   3.8024430660491924`*^9, 3.8024430958091135`*^9}, {3.8024441761729927`*^9, 
   3.802444176384785*^9}, {3.8035048320341372`*^9, 3.8035048440012193`*^9}, {
   3.8035049331846604`*^9, 3.803504983319687*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"b021ac75-16dd-4471-aa79-0a9ef3e9c423"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"first", "[", "temp_", "]"}], ":=", 
   RowBox[{"temp", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"last", "[", "temp_", "]"}], ":=", 
   RowBox[{"temp", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7955343870242696`*^9, 3.795534535934214*^9}, {
   3.795534578413921*^9, 3.7955345788217173`*^9}, 3.795534624432637*^9, {
   3.795535014069836*^9, 3.7955350191019897`*^9}, {3.795535062492176*^9, 
   3.7955350629969077`*^9}, {3.7958825445006905`*^9, 
   3.7958825456430464`*^9}, {3.795882578613974*^9, 3.7958825796383896`*^9}, {
   3.795974769522346*^9, 3.795974774474511*^9}, {3.7959773008679447`*^9, 
   3.795977317950181*^9}, {3.7960442955322123`*^9, 3.796044360564383*^9}, {
   3.7960443944349766`*^9, 3.79604439450194*^9}, {3.7960444808105497`*^9, 
   3.7960444823496675`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"d58956c9-7c1f-495d-a317-9509518a0659"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.94783848127522*^9, 
  3.9478384820049496`*^9}},ExpressionUUID->"80622ed9-4e92-4341-ad8e-\
678f481e1df9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nifinal", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "9"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tolerance", "=", 
   SuperscriptBox["10", 
    RowBox[{"-", "6"}]]}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7948654751860514`*^9, 3.7948655087127314`*^9}, {
   3.7948655485527525`*^9, 3.7948655651831512`*^9}, {3.7948657586872053`*^9, 
   3.794865770919153*^9}, 3.79486762955754*^9, {3.794935062550723*^9, 
   3.7949350632613153`*^9}, {3.794957034057253*^9, 3.7949570365788255`*^9}, 
   3.7951866748617887`*^9, {3.79518673024115*^9, 3.79518673300058*^9}, 
   3.7951867912517033`*^9, 3.7952113549222345`*^9, 3.795212625164954*^9, {
   3.7952135908515573`*^9, 3.7952135913192697`*^9}, {3.795213963157917*^9, 
   3.795213963389763*^9}, {3.7952150850506053`*^9, 3.79521508516252*^9}, 
   3.795220404930103*^9, 3.7952228630799923`*^9, {3.795269990075717*^9, 
   3.7952699937941737`*^9}, 3.795273846946019*^9, {3.7952756655527678`*^9, 
   3.795275667319607*^9}, 3.7952757522586384`*^9, 3.7952758257627335`*^9, {
   3.7953516722288465`*^9, 3.7953516755219927`*^9}, 3.795352378251752*^9, {
   3.795352876748667*^9, 3.795352877546202*^9}, {3.7953533932486095`*^9, 
   3.7953533934594903`*^9}, {3.7953539457609873`*^9, 3.795353945834944*^9}, 
   3.795354565777688*^9, 3.7953546071140785`*^9, {3.7953551822005806`*^9, 
   3.795355182757243*^9}, {3.79536137208582*^9, 3.795361375666774*^9}, {
   3.7953615063481293`*^9, 3.7953615393882627`*^9}, 3.7953635250736475`*^9, {
   3.7953637782900295`*^9, 3.7953637786218185`*^9}, 3.795364797804061*^9, {
   3.7953650487297325`*^9, 3.7953650555528545`*^9}, {3.795365656987916*^9, 
   3.795365657343713*^9}, {3.795433488284385*^9, 3.795433505049144*^9}, {
   3.7954341012079296`*^9, 3.7954341017223196`*^9}, {3.7954341936670256`*^9, 
   3.7954342267513337`*^9}, 3.795434391112644*^9, {3.7954344292120314`*^9, 
   3.7954344293696566`*^9}, {3.7955250384773593`*^9, 3.795525139635577*^9}, {
   3.7955252068332157`*^9, 3.795525313499267*^9}, 3.795525702953596*^9, {
   3.7955258917617483`*^9, 3.7955259213055577`*^9}, 3.7955267145102158`*^9, 
   3.7955267596816053`*^9, {3.7955363372626305`*^9, 3.79553638388594*^9}, {
   3.7955389998817873`*^9, 3.795539007938198*^9}, {3.7955423063231483`*^9, 
   3.7955423178615403`*^9}, 3.795542359351842*^9, {3.7955560940229235`*^9, 
   3.795556100222349*^9}, {3.7955562141576595`*^9, 3.7955562191557918`*^9}, 
   3.7955572386252337`*^9, {3.7955573082950907`*^9, 3.7955573283145247`*^9}, 
   3.7955582639661045`*^9, 3.795558347036178*^9, 3.795559011291204*^9, 
   3.795559216145093*^9, 3.7955594328751383`*^9, {3.7955601982596054`*^9, 
   3.7955601985554357`*^9}, {3.7955604388279057`*^9, 3.795560463755534*^9}, {
   3.7955607731461544`*^9, 3.795560773264086*^9}, 3.795561649974618*^9, 
   3.79556177926972*^9, {3.7955618843168077`*^9, 3.795561886027839*^9}, 
   3.7955619566760893`*^9, 3.795562005740801*^9, {3.795562086532238*^9, 
   3.7955620897703533`*^9}, 3.79556213976353*^9, 3.795562197939988*^9, 
   3.7955624826988106`*^9, {3.7956194123777266`*^9, 3.7956194393521748`*^9}, 
   3.795619627000986*^9, {3.79561985472769*^9, 3.7956198575820446`*^9}, 
   3.7956204269338655`*^9, {3.7956207640514994`*^9, 3.795620764242407*^9}, 
   3.7956214427030935`*^9, 3.7956221487819853`*^9, {3.795776501846193*^9, 
   3.7957765892822247`*^9}, {3.795790633713451*^9, 3.7957906584643126`*^9}, {
   3.795801152595765*^9, 3.7958011563396325`*^9}, 3.795802657642499*^9, {
   3.795818564264019*^9, 3.795818564432893*^9}, {3.795818961567436*^9, 
   3.7958189618202744`*^9}, {3.795819358460576*^9, 3.795819358811392*^9}, {
   3.795820131665577*^9, 3.795820138070898*^9}, 3.7958639512397814`*^9, 
   3.795864026821636*^9, 3.795864211461161*^9, 3.7958643302353783`*^9, {
   3.7958645020025115`*^9, 3.7958645049051895`*^9}, {3.795864576029975*^9, 
   3.795864580202359*^9}, 3.7958647298882647`*^9, {3.795865267615039*^9, 
   3.795865268122291*^9}, 3.7958653456216984`*^9, {3.795866102504513*^9, 
   3.795866103323052*^9}, {3.795866138075202*^9, 3.7958661591361637`*^9}, {
   3.7958662291641426`*^9, 3.7958662293630323`*^9}, {3.795866278796796*^9, 
   3.795866281978981*^9}, 3.795867143470476*^9, {3.7958672512069407`*^9, 
   3.795867253042883*^9}, {3.7958821481444607`*^9, 3.795882160855199*^9}, {
   3.79606223004617*^9, 3.796062240177372*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"9f274614-58be-48d7-8890-49eeeb7d2465"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "solution", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Export\>\"", "\[Rule]", "\"\<False\>\""}], ",", 
     RowBox[{"\"\<Utility\>\"", "\[Rule]", "\"\<Log\>\""}], ",", 
     RowBox[{"\"\<Debug\>\"", "\[Rule]", "\"\<False\>\""}], ",", 
     RowBox[{"\"\<FX\>\"", "\[Rule]", "1"}], ",", 
     RowBox[{"\"\<Ns0\>\"", "\[Rule]", "\"\<SIR\>\""}], ",", 
     RowBox[{"\"\<Silent\>\"", "\[Rule]", "\"\<False\>\""}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"solution", "[", 
    RowBox[{
    "\[Alpha]0_", ",", "\[Beta]0_", ",", "\[Gamma]0_", ",", "\[Delta]0_", ",",
      "\[Rho]0_", ",", "\[Kappa]0_", ",", "ni00_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", "\[Alpha]0"}], ",", 
       RowBox[{"\[Beta]", "=", "\[Beta]0"}], ",", 
       RowBox[{"\[Gamma]", "=", "\[Gamma]0"}], ",", 
       RowBox[{"\[Delta]", "=", "\[Delta]0"}], ",", 
       RowBox[{"\[Rho]", "=", "\[Rho]0"}], ",", 
       RowBox[{"\[Kappa]", "=", "\[Kappa]0"}], ",", 
       RowBox[{"ni0", "=", "ni00"}], ",", 
       RowBox[{"R0", "=", 
        FractionBox["\[Beta]0", "\[Gamma]0"]}], ",", 
       RowBox[{"fx", "=", 
        RowBox[{"OptionValue", "[", "\"\<FX\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "\[NotEqual]", 
         "\"\<False\>\""}], ",", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Invert", " ", "optimality", " ", "condition", " ", "to", " ", "find", 
        " ", 
        RowBox[{
         RowBox[{"a", "[", "t", "]"}], ".", "  ", "Only"}], " ", "programmed",
         " ", "for", " ", "two", " ", "utility", " ", "functions"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], "\[Equal]", 
         "\"\<Log\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{
           "\[Alpha]_", ",", "\[Beta]_", ",", "ns_", ",", "ni_", ",", 
            "\[Lambda]s_", ",", "\[Lambda]i_"}], "]"}], ":=", 
          FractionBox[
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"ns", "+", "ni"}], ")"}]}], "+", 
            RowBox[{
             SqrtBox[
              RowBox[{"ns", "+", "ni"}]], " ", 
             SqrtBox[
              RowBox[{"ns", "+", "ni", "+", 
               RowBox[{"4", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "\[Alpha]"}], ")"}], "\[Beta]", " ", "ni", 
                " ", "ns", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Lambda]s", "-", "\[Lambda]i"}], ")"}]}]}]]}]}], 
           RowBox[{"2", 
            RowBox[{"(", 
             RowBox[{"1", "+", "\[Alpha]"}], ")"}], " ", "\[Beta]", " ", "ns",
             " ", "ni", 
            RowBox[{"(", 
             RowBox[{"\[Lambda]s", "-", "\[Lambda]i"}], ")"}]}]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"u", "[", "a_", "]"}], ":=", 
          RowBox[{
           RowBox[{"Log", "[", "a", "]"}], "-", "a", "+", "1"}]}]}]}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], "\[Equal]", 
         "\"\<Quadratic\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{
           "\[Alpha]_", ",", "\[Beta]_", ",", "ns_", ",", "ni_", ",", 
            "\[Lambda]s_", ",", "\[Lambda]i_"}], "]"}], ":=", 
          FractionBox[
           RowBox[{"ns", "+", "ni"}], 
           RowBox[{"ns", "+", "ni", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Alpha]"}], ")"}], " ", "\[Beta]", " ", 
             "ns", " ", "ni", 
             RowBox[{"(", 
              RowBox[{"\[Lambda]s", "-", "\[Lambda]i"}], ")"}]}]}]]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"u", "[", "a_", "]"}], ":=", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "1"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", "a"}], ")"}], "2"]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Ns0\>\"", "]"}], "\[Equal]", 
         "\"\<SIR\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", "  ", 
         RowBox[{
          RowBox[{"Initial", " ", "value", " ", "of", " ", 
           SubscriptBox["N", "r"]}], ";", " ", 
          RowBox[{
           RowBox[{
           "determined", " ", "by", " ", "assumption", " ", "that", " ", 
            RowBox[{"A", "[", "t", "]"}]}], "\[Equal]", 
           RowBox[{"1", " ", "for", " ", "t"}], " ", "<", " ", "1"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Clear", "[", "nr0", "]"}], ";", 
         RowBox[{"nr0", "=", 
          RowBox[{"nr0", "/.", 
           RowBox[{"FindRoot", "[", 
            RowBox[{
             RowBox[{"ni0", "\[Equal]", 
              RowBox[{"1", "-", "nr0", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 FractionBox[
                  RowBox[{"-", "\[Beta]"}], "\[Gamma]"], " ", "nr0"}], 
                "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"nr0", ",", 
               FractionBox["ni0", 
                RowBox[{
                 FractionBox["\[Beta]", "\[Gamma]"], "-", "1"}]]}], "}"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ns0", "=", 
          RowBox[{"1", "-", "ni0", "-", "nr0"}]}], ";"}], "  ", 
        RowBox[{"(*", " ", 
         RowBox[{"Initial", " ", "value", " ", "for", " ", 
          SubscriptBox["N", "s"]}], " ", "*)"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Initial", " ", "value", " ", "of", " ", 
          SubscriptBox["N", "s"], " ", "specified", " ", "exogenously"}], " ",
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ns0", "=", 
          RowBox[{"OptionValue", "[", "\"\<Ns0\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"nr0", "=", 
          RowBox[{"1", "-", "ns0", "-", "ni0"}]}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"loop", "=", "0"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Counts", " ", "how", " ", "many", " ", "times", " ", "we", " ", 
         "re"}], "-", 
        RowBox[{"search", " ", "for", " ", 
         RowBox[{
          SubscriptBox["N", "s"], "."}]}]}], "  ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"T", "[", "loop", "]"}], "=", "0"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Normalize", " ", "terminal", " ", "date", " ", "to", " ", "0"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"stopper", "=", "0"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Will", " ", "switch", " ", "to", " ", "1", " ", "when", " ", "we", 
        " ", "have", " ", "found", " ", "the", " ", "saddle", " ", "path"}], 
       " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"nsMax", "=", "1"}], ";", 
      RowBox[{"nsMin", "=", "0"}], ";", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Extreme", " ", "possibilities", " ", "for", " ", "terminal", " ", 
        "condition", " ", "for", " ", 
        SubscriptBox["N", "s"]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "niT", ",", "\[Lambda]sT", ",", "\[Lambda]iT", ",", "HealthCostT", 
         ",", "TotalCostT"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{"nifinal", ",", 
         FractionBox[
          RowBox[{"\[Beta]", " ", 
           RowBox[{"\[Lambda]i", "[", 
            RowBox[{"T", "[", "loop", "]"}], "]"}], " ", 
           RowBox[{"ni", "[", 
            RowBox[{"T", "[", "loop", "]"}], "]"}]}], 
          RowBox[{"\[Rho]", "+", "\[Delta]", "+", 
           RowBox[{"\[Beta]", " ", 
            RowBox[{"ni", "[", 
             RowBox[{"T", "[", "loop", "]"}], "]"}]}]}]], ",", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Gamma]", " ", "\[Kappa]", 
            RowBox[{"(", 
             RowBox[{"\[Delta]", "+", "\[Rho]", "+", 
              RowBox[{"\[Beta]", " ", 
               RowBox[{"ni", "[", 
                RowBox[{"T", "[", "loop", "]"}], "]"}]}]}], ")"}]}], 
           RowBox[{
            RowBox[{"\[Alpha]", " ", 
             SuperscriptBox["\[Beta]", "2"], 
             RowBox[{"ni", "[", 
              RowBox[{"T", "[", "loop", "]"}], "]"}], 
             RowBox[{"ns", "[", 
              RowBox[{"T", "[", "loop", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Delta]", "+", "\[Rho]", "+", 
               RowBox[{"\[Beta]", " ", 
                RowBox[{"ni", "[", 
                 RowBox[{"T", "[", "loop", "]"}], "]"}]}]}], ")"}], 
             RowBox[{"(", 
              RowBox[{"\[Rho]", "+", "\[Delta]", "+", "\[Gamma]", "-", 
               RowBox[{"\[Alpha]", " ", "\[Beta]", " ", 
                RowBox[{"ns", "[", 
                 RowBox[{"T", "[", "loop", "]"}], "]"}]}]}], ")"}]}]}]]}], 
         ",", "0", ",", "0"}], "}"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Terminal", " ", "conditions", " ", "for", " ", 
         SubscriptBox["N", "i"], " ", "and", " ", "two", " ", 
         RowBox[{"costates", ".", "  ", "Costate"}], " ", "conditions", " ", 
         "are", " ", "determined", " ", "by", " ", "setting", " ", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Lambda]", "i"], "'"}], "[", "T", "]"}]}], 
        "\[Equal]", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[Lambda]", "s"], "'"}], "[", "T", "]"}], "\[Equal]", 
        "0"}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Main", " ", "loop"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"stopper", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Find", " ", "the", " ", "terminal", " ", "value", " ", "of", " ", 
          SubscriptBox["N", "s"]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"nsMax", "-", "nsMin"}], ">", 
            SuperscriptBox["10", 
             RowBox[{"-", "12"}]]}], ",", "  ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "Stops", " ", "when", " ", "upper", " ", "and", " ", "lower", " ",
              "bounds", " ", "on", " ", 
             SubscriptBox["N", "s"], " ", "lie", " ", "within", " ", 
             SuperscriptBox["10", 
              RowBox[{"-", "12"}]]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"trigger", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"temp", "=", 
             RowBox[{
              RowBox[{"NDSolve", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"ns", "'"}], "[", "t", "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{"-", "\[Beta]"}], " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"], 
                    RowBox[{"ns", "[", "t", "]"}], " ", 
                    RowBox[{"ni", "[", "t", "]"}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ni", "'"}], "[", "t", "]"}], "==", 
                   RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"], 
                    RowBox[{"ns", "[", "t", "]"}], " ", 
                    RowBox[{"ni", "[", "t", "]"}]}], "-", 
                    RowBox[{"\[Gamma]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Delta]"}], ")"}], 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Lambda]s", "'"}], "[", "t", "]"}]}], 
                   "\[Equal]", 
                   RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Lambda]i", "[", "t", "]"}], "-", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}]}], ")"}], "\[Beta]",
                     " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"], 
                    RowBox[{"ni", "[", "t", "]"}]}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Delta]"}], ")"}], 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"\[Lambda]i", "'"}], "[", "t", "]"}]}], 
                   "\[Equal]", 
                   RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "]"}], 
                    "+", 
                    RowBox[{"\[Alpha]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Lambda]i", "[", "t", "]"}], "-", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}]}], ")"}], "\[Beta]",
                     " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"], 
                    RowBox[{"ns", "[", "t", "]"}]}], "-", 
                    RowBox[{"\[Gamma]", 
                    RowBox[{"(", 
                    RowBox[{"\[Kappa]", "+", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], ")"}]}]}]}], ",",
                   "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"HealthCost", "'"}], "[", "t", "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Delta]"}], ")"}], 
                    RowBox[{"HealthCost", "[", "t", "]"}]}], "-", 
                    RowBox[{"\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"TotalCost", "'"}], "[", "t", "]"}], "\[Equal]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Rho]", "+", "\[Delta]"}], ")"}], 
                    RowBox[{"TotalCost", "[", "t", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], "+", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}], 
                    RowBox[{"u", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "]"}]}], 
                    "-", 
                    RowBox[{"\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}]}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ns", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}], "\[Equal]", 
                   FractionBox[
                    RowBox[{"nsMax", "+", "nsMin"}], "2"]}], ",", 
                  RowBox[{
                   RowBox[{"ni", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}], "\[Equal]", 
                   "niT"}], ",", 
                  RowBox[{
                   RowBox[{"\[Lambda]s", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}], "\[Equal]", 
                   "\[Lambda]sT"}], ",", 
                  RowBox[{
                   RowBox[{"\[Lambda]i", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}], "\[Equal]", 
                   "\[Lambda]iT"}], ",", 
                  RowBox[{
                   RowBox[{"HealthCost", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}], "\[Equal]", 
                   "HealthCostT"}], ",", 
                  RowBox[{
                   RowBox[{"TotalCost", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}], "\[Equal]", 
                   "TotalCostT"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"WhenEvent", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], "\[GreaterEqual]", "ns0"}],
                     "||", 
                    RowBox[{
                    RowBox[{"ni", "[", "t", "]"}], "\[LessEqual]", 
                    "nifinal"}]}], ",", "\"\<StopIntegration\>\""}], "]"}]}], 
                 "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                 "ns", ",", "ni", ",", "\[Lambda]s", ",", "\[Lambda]i", ",", 
                  "HealthCost", ",", "TotalCost"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", 
                  RowBox[{"-", "\[Infinity]"}], ",", 
                  RowBox[{"T", "[", "loop", "]"}]}], "}"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ";", "  ", 
            RowBox[{"(*", " ", 
             RowBox[{"Solve", " ", "ODE", " ", 
              RowBox[{"system", ".", "  ", "Note"}], " ", "the", " ", "extra",
               " ", "equations", " ", "allow", " ", "us", " ", "to", " ", 
              "directly", " ", "compute", " ", "health", " ", "costs", " ", 
              "and", " ", "total", " ", "costs"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ns", "[", 
                  RowBox[{"first", "[", "temp", "]"}], "]"}], "+", 
                 RowBox[{"ni", "[", 
                  RowBox[{"first", "[", "temp", "]"}], "]"}]}], "<", 
                RowBox[{"ns0", "+", "ni0"}]}], "/.", "temp"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"neg", "=", "temp"}], ";", 
               RowBox[{"nsMax", "=", 
                FractionBox[
                 RowBox[{"nsMax", "+", "nsMin"}], "2"]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"pos", "=", "temp"}], ";", 
               RowBox[{"nsMin", "=", 
                FractionBox[
                 RowBox[{"nsMax", "+", "nsMin"}], "2"]}]}]}], "]"}]}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Check", " ", "whether", " ", "solution", " ", "lies", " ", 
            "above", " ", "or", " ", "below", " ", "saddle", " ", "path", " ",
             "and", " ", "store", " ", "it"}], " ", "*)"}], 
          "\[IndentingNewLine]", "]"}], ";", " ", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Save", " ", "intermediate", " ", "results", " ", "if", " ", 
           "debug", " ", "is", " ", "on"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "\"\<Debug\>\"", "]"}], "\[Equal]", 
            "True"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], 
                   "\[Equal]", "\"\<Log\>\""}], ",", "\"\<Results\>\"", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], 
                    "\[Equal]", "\"\<Quadratic\>\""}], ",", 
                    "\"\<Quadratic\>\""}], "]"}]}], "]"}], ",", 
                "\"\<_alpha\>\"", ",", 
                RowBox[{"ToString", "[", "\[Alpha]", "]"}], ",", 
                "\"\<_gamma\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"\[Gamma]", ",", "3"}], "]"}], "]"}], ",", 
                "\"\<_beta\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"\[Beta]", ",", "3"}], "]"}], "]"}], ",", 
                "\"\<_kappa\>\"", ",", 
                RowBox[{"ToString", "[", "\[Kappa]", "]"}], ",", 
                "\"\<_delta\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"\[Delta]", ",", "3"}], "]"}], "]"}], ",", 
                "\"\<_Ni\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"N", "[", "ni0", "]"}], ",", 
                   RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], "]"}], 
                ",", "\"\<_pos\>\"", ",", 
                RowBox[{"ToString", "[", "loop", "]"}], ",", "\"\<.dat\>\""}],
                "]"}], ",", 
              RowBox[{"N", "[", 
               RowBox[{"Prepend", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "12"}], ",", "6"}], "}"}]}]}], "]"}]}], 
                    "}"}], "/.", "pos"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"last", "[", "pos", "]"}], ",", 
                    RowBox[{"first", "[", "pos", "]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", "Ns", ",", "Ni"}], "}"}]}], "]"}], 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"Export", "[", 
             RowBox[{
              RowBox[{"StringJoin", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], 
                   "\[Equal]", "\"\<Log\>\""}], ",", "\"\<Results\>\"", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], 
                    "\[Equal]", "\"\<Quadratic\>\""}], ",", 
                    "\"\<Quadratic\>\""}], "]"}]}], "]"}], ",", 
                "\"\<_alpha\>\"", ",", 
                RowBox[{"ToString", "[", "\[Alpha]", "]"}], ",", 
                "\"\<_gamma\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"\[Gamma]", ",", "3"}], "]"}], "]"}], ",", 
                "\"\<_beta\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"\[Beta]", ",", "3"}], "]"}], "]"}], ",", 
                "\"\<_kappa\>\"", ",", 
                RowBox[{"ToString", "[", "\[Kappa]", "]"}], ",", 
                "\"\<_delta\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"\[Delta]", ",", "3"}], "]"}], "]"}], ",", 
                "\"\<_Ni\>\"", ",", 
                RowBox[{"ToString", "[", 
                 RowBox[{"NumberForm", "[", 
                  RowBox[{
                   RowBox[{"N", "[", "ni0", "]"}], ",", 
                   RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], "]"}], 
                ",", "\"\<_neg\>\"", ",", 
                RowBox[{"ToString", "[", "loop", "]"}], ",", "\"\<.dat\>\""}],
                "]"}], ",", 
              RowBox[{"N", "[", 
               RowBox[{"Prepend", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "12"}], ",", "6"}], "}"}]}]}], "]"}]}], 
                    "}"}], "/.", "neg"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"last", "[", "neg", "]"}], ",", 
                    RowBox[{"first", "[", "neg", "]"}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", "Ns", ",", "Ni"}], "}"}]}], "]"}], 
               "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sol", "[", "loop", "]"}], "=", "temp"}], ";", "  ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Store", " ", "solution", " ", "that", " ", "is", " ", "closes", 
           " ", "to", " ", "the", " ", "saddle", " ", "path"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "If", " ", "we", " ", "did", " ", "not", " ", "hit", " ", "the", 
            " ", "desired", " ", "initial", " ", "condition"}], ",", " ", 
           RowBox[{
           "look", " ", "for", " ", "the", " ", "point", " ", "when", " ", 
            "the", " ", "paths", " ", "above", " ", "and", " ", "below", " ", 
            "the", " ", "saddle", " ", "where", " ", "the", " ", "two", " ", 
            "paths", " ", "first", " ", "diverge", " ", "by", " ", "at", " ", 
            "least", " ", "\"\<tolerance\>\"", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"in", " ", "logs"}], ")"}], ".", "  ", "This"}], " ", 
            "is", " ", "the", " ", "new", " ", "terminal", " ", "condition", 
            " ", "for", " ", "the", " ", "ODE", " ", "system"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{
               RowBox[{"ns", "[", 
                RowBox[{"first", "[", "temp", "]"}], "]"}], "+", 
               RowBox[{"ni", "[", 
                RowBox[{"first", "[", "temp", "]"}], "]"}], "-", "ns0", "-", 
               "ni0"}], "]"}], "<", "tolerance"}], "/.", "temp"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"stopper", "=", "1"}], ";", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"loop", "+", "1"}], "]"}], "=", 
             RowBox[{"first", "[", "temp", "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"T0", "=", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"first", "[", "neg", "]"}], ",", 
               RowBox[{"first", "[", "pos", "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"ns", "[", "T0", "]"}], "/.", "neg"}], 
                  RowBox[{
                   RowBox[{"ns", "[", "T0", "]"}], "/.", "pos"}]], "]"}], 
                "]"}], ">", "tolerance"}], ",", 
              RowBox[{"t1", "=", 
               RowBox[{"t", "/.", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Log", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], "/.", "neg"}], 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], "/.", "pos"}]], "]"}], 
                    "]"}], "\[Equal]", "tolerance"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "T0", ",", 
                    RowBox[{"T", "[", "loop", "]"}]}], "}"}]}], "]"}]}]}], 
              ",", 
              RowBox[{"t1", "=", "T0"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"ni", "[", "T0", "]"}], "/.", "neg"}], 
                  RowBox[{
                   RowBox[{"ni", "[", "T0", "]"}], "/.", "pos"}]], "]"}], 
                "]"}], ">", "tolerance"}], ",", 
              RowBox[{"t2", "=", 
               RowBox[{"t", "/.", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Log", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"ni", "[", "t", "]"}], "/.", "neg"}], 
                    RowBox[{
                    RowBox[{"ni", "[", "t", "]"}], "/.", "pos"}]], "]"}], 
                    "]"}], "\[Equal]", "tolerance"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "T0", ",", 
                    RowBox[{"T", "[", "loop", "]"}]}], "}"}]}], "]"}]}]}], 
              ",", 
              RowBox[{"t2", "=", "T0"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Lambda]s", "[", "T0", "]"}], "/.", "neg"}], 
                  RowBox[{
                   RowBox[{"\[Lambda]s", "[", "T0", "]"}], "/.", "pos"}]], 
                 "]"}], "]"}], ">", "tolerance"}], ",", 
              RowBox[{"t3", "=", 
               RowBox[{"t", "/.", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Log", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], "/.", "neg"}], 
                    RowBox[{
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], "/.", "pos"}]], 
                    "]"}], "]"}], "\[Equal]", "tolerance"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "T0", ",", 
                    RowBox[{"T", "[", "loop", "]"}]}], "}"}]}], "]"}]}]}], 
              ",", 
              RowBox[{"t3", "=", "T0"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"Log", "[", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"\[Lambda]i", "[", "T0", "]"}], "/.", "neg"}], 
                  RowBox[{
                   RowBox[{"\[Lambda]i", "[", "T0", "]"}], "/.", "pos"}]], 
                 "]"}], "]"}], ">", "tolerance"}], ",", 
              RowBox[{"t4", "=", 
               RowBox[{"t", "/.", 
                RowBox[{"FindRoot", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Log", "[", 
                    FractionBox[
                    RowBox[{
                    RowBox[{"\[Lambda]i", "[", "t", "]"}], "/.", "neg"}], 
                    RowBox[{
                    RowBox[{"\[Lambda]i", "[", "t", "]"}], "/.", "pos"}]], 
                    "]"}], "]"}], "\[Equal]", "tolerance"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "T0", ",", 
                    RowBox[{"T", "[", "loop", "]"}]}], "}"}]}], "]"}]}]}], 
              ",", 
              RowBox[{"t4", "=", "T0"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"T", "[", 
              RowBox[{"loop", "+", "1"}], "]"}], "=", 
             RowBox[{"Max", "[", 
              RowBox[{"t2", ",", "t2", ",", "t3", ",", "t4"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"loop", "+=", "1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"Set", " ", "the", " ", "terminal", " ", "values"}], 
              ",", " ", 
              RowBox[{
              "including", " ", "the", " ", "new", " ", "extreme", " ", 
               "points", " ", "for", " ", 
               SubscriptBox["N", "s"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "nsMax", ",", "nsMin", ",", "niT", ",", "\[Lambda]sT", ",", 
               "\[Lambda]iT", ",", "HealthCostT", ",", "TotalCostT"}], "}"}], 
             "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"ns0", "+", 
                    RowBox[{"ns", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}]}], "2"], ",", 
                  RowBox[{"1.1", 
                   RowBox[{"ns", "[", 
                    RowBox[{"T", "[", "loop", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"0.9", 
                 RowBox[{"ns", "[", 
                  RowBox[{"T", "[", "loop", "]"}], "]"}]}], ",", 
                RowBox[{"ni", "[", 
                 RowBox[{"T", "[", "loop", "]"}], "]"}], ",", 
                RowBox[{"\[Lambda]s", "[", 
                 RowBox[{"T", "[", "loop", "]"}], "]"}], ",", 
                RowBox[{"\[Lambda]i", "[", 
                 RowBox[{"T", "[", "loop", "]"}], "]"}], ",", 
                RowBox[{"HealthCost", "[", 
                 RowBox[{"T", "[", "loop", "]"}], "]"}], ",", 
                RowBox[{"TotalCost", "[", 
                 RowBox[{"T", "[", "loop", "]"}], "]"}]}], "}"}], "/.", 
              "temp"}]}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"steps", "=", "loop"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Export", " ", "results"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "\[NotEqual]", 
         "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], 
                "\[Equal]", "\"\<Log\>\""}], ",", "\"\<Results\>\"", ",", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "[", "\"\<Utility\>\"", "]"}], 
                  "\[Equal]", "\"\<Quadratic\>\""}], ",", 
                 "\"\<Quadratic\>\""}], "]"}]}], "]"}], ",", "\"\<_alpha\>\"",
              ",", 
             RowBox[{"ToString", "[", "\[Alpha]", "]"}], ",", 
             "\"\<_gamma\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", 
               RowBox[{"\[Gamma]", ",", "3"}], "]"}], "]"}], ",", 
             "\"\<_beta\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", 
               RowBox[{"\[Beta]", ",", "3"}], "]"}], "]"}], ",", 
             "\"\<_kappa\>\"", ",", 
             RowBox[{"ToString", "[", "\[Kappa]", "]"}], ",", 
             "\"\<_delta\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", 
               RowBox[{"\[Delta]", ",", "3"}], "]"}], "]"}], ",", 
             "\"\<_Ni\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "[", "ni0", "]"}], ",", 
                RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], "]"}], 
             ",", "\"\<.dat\>\""}], "]"}], ",", 
           RowBox[{"N", "[", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{"Partition", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"328000000", " ", "0.0062", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"ns", "[", "t", "]"}], "-", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}]}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "9"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    RowBox[{
                    FractionBox["\[Beta]", "\[Gamma]"], " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"]}], 
                    "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{
                    FractionBox["\[Beta]", "\[Gamma]"], " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"], 
                    RowBox[{"ns", "[", "t", "]"}]}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"fx", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ")"}]}], "]"}], 
                    "\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"fx", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ")"}]}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], "+", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}], 
                    RowBox[{"u", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "]"}]}]}],
                     ")"}]}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}]}], "}"}],
                     "/.", 
                    RowBox[{"sol", "[", "n", "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"T", "[", 
                    RowBox[{"n", "+", "1"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"T", "[", "n", "]"}], ",", 
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}], "+", 
                    RowBox[{"4", " ", "730"}]}]}], "]"}]}], "}"}]}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "steps", ",", 
                    RowBox[{
                    RowBox[{"Floor", "[", "x", "]"}], "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{
                    RowBox[{"T", "[", "n", "]"}], "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"steps", "+", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                    "[", "x", "]"}], "\[Equal]", 
                    RowBox[{"2", " ", "730"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "steps"}], "}"}]}], "]"}]}], ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", "9"}], 
                 "]"}], ",", "740"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "t", ",", "Ns", ",", "Ni", ",", "\"\<Dead_pi_0.0062\>\"", ",", 
                "A", ",", "LogRS", ",", "Rt", ",", "DiscHealthCost", ",", 
                "DiscTotalCost"}], "}"}]}], "]"}], "]"}]}], "]"}], "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Silent\>\"", "]"}], "\[Equal]", 
         "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Report", " ", "health", " ", "and", " ", "total", " ", "costs"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<Health Cost: \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"fx", " ", 
                RowBox[{"HealthCost", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"steps", "+", "1"}], "]"}], "]"}]}], "]"}], "/.", 
              RowBox[{"sol", "[", "steps", "]"}]}], "]"}]}], "]"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<Activity Cost: \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"fx", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"TotalCost", "[", 
                   RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}], "]"}], "-", 
                  RowBox[{"HealthCost", "[", 
                   RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}], "]"}]}], ")"}]}], 
               "]"}], "/.", 
              RowBox[{"sol", "[", "steps", "]"}]}], "]"}]}], "]"}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<Total Cost: \>\"", ",", 
            RowBox[{"ToString", "[", 
             RowBox[{
              RowBox[{"Round", "[", 
               RowBox[{"fx", " ", 
                RowBox[{"TotalCost", "[", 
                 RowBox[{"T", "[", 
                  RowBox[{"steps", "+", "1"}], "]"}], "]"}]}], "]"}], "/.", 
              RowBox[{"sol", "[", "steps", "]"}]}], "]"}]}], "]"}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7955343870242696`*^9, 3.795534535934214*^9}, {
   3.795534578413921*^9, 3.7955345788217173`*^9}, 3.795534624432637*^9, {
   3.795535014069836*^9, 3.7955350191019897`*^9}, {3.795535062492176*^9, 
   3.7955350629969077`*^9}, {3.7958825445006905`*^9, 
   3.7958825456430464`*^9}, {3.795882578613974*^9, 3.7958825796383896`*^9}, {
   3.795974769522346*^9, 3.795974774474511*^9}, {3.7959773008679447`*^9, 
   3.795977317950181*^9}, {3.7960442955322123`*^9, 3.796044360564383*^9}, {
   3.7960443944349766`*^9, 3.79604439450194*^9}, 3.7960444808105497`*^9, {
   3.7960621375461254`*^9, 3.796062159401642*^9}, {3.796062502887*^9, 
   3.79606250816298*^9}, 3.796062820219845*^9, {3.796063289146594*^9, 
   3.796063309541913*^9}, {3.796063343966186*^9, 3.796063348132818*^9}, {
   3.7961245461420875`*^9, 3.7961245882280226`*^9}, {3.797871426691185*^9, 
   3.7978714758060875`*^9}, 3.7978716002037497`*^9, {3.7984146401223907`*^9, 
   3.798414674169804*^9}, 3.7984147296148963`*^9, {3.79841476733317*^9, 
   3.7984147963834667`*^9}, {3.798414862906169*^9, 3.798414879734475*^9}, {
   3.798475506526888*^9, 3.798475554825272*^9}, {3.7984756016804276`*^9, 
   3.7984756049156027`*^9}, {3.801482222124934*^9, 3.8014822735045347`*^9}, {
   3.8014823545631104`*^9, 3.8014823634000225`*^9}, {3.801484698153084*^9, 
   3.8014847330930986`*^9}, {3.801493215163517*^9, 3.801493276152562*^9}, {
   3.801493577916752*^9, 3.801493602177861*^9}, {3.8015037200672817`*^9, 
   3.801503755167178*^9}, {3.8015063299212065`*^9, 3.80150635628754*^9}, {
   3.8015673378020744`*^9, 3.80156738340092*^9}, {3.801567424491371*^9, 
   3.8015674717822533`*^9}, {3.8015880725275574`*^9, 3.801588078816928*^9}, {
   3.8015881121828127`*^9, 3.8015882008469563`*^9}, {3.8015882342917523`*^9, 
   3.8015883284597363`*^9}, {3.801932603288195*^9, 3.8019326033891363`*^9}, {
   3.8020068165476537`*^9, 3.8020069709220343`*^9}, {3.802007001625433*^9, 
   3.802007081647518*^9}, {3.8020072339918423`*^9, 3.8020072361225924`*^9}, {
   3.802007275660931*^9, 3.802007277463896*^9}, {3.802007350587929*^9, 
   3.802007354414706*^9}, {3.8020073986223583`*^9, 3.8020074007961087`*^9}, {
   3.8020075991532555`*^9, 3.8020076758102818`*^9}, {3.8020181271651974`*^9, 
   3.8020181368906145`*^9}, 3.8020186635953455`*^9, {3.802019176013946*^9, 
   3.802019355339034*^9}, {3.8020873812434807`*^9, 3.802087384074483*^9}, {
   3.8020892359525676`*^9, 3.8020892927270145`*^9}, {3.8020894618569255`*^9, 
   3.802089466563243*^9}, {3.802089891647276*^9, 3.802089897005228*^9}, {
   3.8020900176159844`*^9, 3.8020900180257783`*^9}, {3.8020900682389617`*^9, 
   3.8020901084648485`*^9}, {3.802090267206749*^9, 3.8020903017979174`*^9}, {
   3.8020926987844563`*^9, 3.802093086783772*^9}, {3.8020931210418453`*^9, 
   3.80209327474361*^9}, {3.8020941996048765`*^9, 3.8020942673919697`*^9}, {
   3.802094298945839*^9, 3.802094498703228*^9}, {3.80209461614783*^9, 
   3.8020946213568316`*^9}, {3.802440811061198*^9, 3.802440885057757*^9}, {
   3.802440949169958*^9, 3.802440957622106*^9}, 3.802441017657916*^9, {
   3.802444168155859*^9, 3.802444168514698*^9}, {3.8032506086485367`*^9, 
   3.803250619774119*^9}, {3.80325066937844*^9, 3.803250721828103*^9}, {
   3.8032508163144765`*^9, 3.80325084339482*^9}, {3.803251168064143*^9, 
   3.8032512044630923`*^9}, {3.8227422081627398`*^9, 
   3.8227422532548847`*^9}, {3.8227422885256743`*^9, 3.822742389762657*^9}, {
   3.8227578311531553`*^9, 3.8227578911597624`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"c4253f65-2879-4612-9f5f-01ee2c6e8bcf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "shock", "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Export\>\"", "\[Rule]", "\"\<False\>\""}], ",", 
     RowBox[{"\"\<FX\>\"", "\[Rule]", "1"}]}], "}"}]}], ";", 
  RowBox[{
   RowBox[{"shock", "[", 
    RowBox[{
    "\[Alpha]0_", ",", "\[Beta]0_", ",", "\[Gamma]0_", ",", "\[Delta]0_", ",",
      "\[Rho]0_", ",", "\[Kappa]0_", ",", "ni00_", ",", "T10_", ",", "T20_", 
     ",", "z0_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "=", "\[Alpha]0"}], ",", 
       RowBox[{"\[Beta]", "=", "\[Beta]0"}], ",", 
       RowBox[{"\[Gamma]", "=", "\[Gamma]0"}], ",", 
       RowBox[{"\[Delta]", "=", "\[Delta]0"}], ",", 
       RowBox[{"\[Rho]", "=", "\[Rho]0"}], ",", 
       RowBox[{"\[Kappa]", "=", "\[Kappa]0"}], ",", 
       RowBox[{"ni0", "=", "ni00"}], ",", 
       RowBox[{"R0", "=", 
        FractionBox["\[Beta]0", "\[Gamma]0"]}], ",", 
       RowBox[{"T1", "=", "T10"}], ",", 
       RowBox[{"T2", "=", "T20"}], ",", 
       RowBox[{"z", "=", "z0"}], ",", 
       RowBox[{"fx", "=", 
        RowBox[{"OptionValue", "[", "\"\<FX\>\"", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "\[NotEqual]", 
         "\"\<False\>\""}], ",", 
        RowBox[{"SetDirectory", "[", 
         RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "]"}]}], "]"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Initial", " ", "phase"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"solution", "[", 
       RowBox[{
       "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "\[Delta]", ",", 
        "\[Rho]", ",", "\[Kappa]", ",", "ni0", ",", 
        RowBox[{"FX", "\[Rule]", "fx"}], ",", 
        RowBox[{"Silent", "\[Rule]", "True"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"results1", "=", 
       RowBox[{"N", "[", 
        RowBox[{"Take", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"328000000", " ", ".0062", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"ns", "[", "t", "]"}], "-", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}]}], ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{
                    FractionBox["\[Beta]", "\[Gamma]"], " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"]}], 
                    "]"}], ",", 
                    RowBox[{
                    FractionBox["\[Beta]", "\[Gamma]"], " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"], 
                    RowBox[{"ns", "[", "t", "]"}]}], ",", 
                    RowBox[{"fx", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ")"}]}], "]"}], 
                    "\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"fx", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ")"}]}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], "+", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}], 
                    RowBox[{"u", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "]"}]}]}],
                     ")"}]}]}], "}"}], "/.", 
                  RowBox[{"sol", "[", "n", "]"}]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"t", ",", 
                   RowBox[{"T", "[", 
                    RowBox[{"n", "+", "1"}], "]"}], ",", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"T", "[", "n", "]"}], ",", 
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}], "+", 
                    RowBox[{"4", " ", "730"}]}]}], "]"}]}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "steps", ",", 
                 RowBox[{
                  RowBox[{"Floor", "[", "x", "]"}], "/.", 
                  RowBox[{"FindRoot", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{
                    RowBox[{"T", "[", "n", "]"}], "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"steps", "+", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                    "[", "x", "]"}], "\[Equal]", 
                    RowBox[{"2", " ", "730"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "steps"}], "}"}]}], "]"}]}], ",", 
                 RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", "9"}], 
           "]"}], ",", 
          RowBox[{"T1", "+", "T2", "+", "1"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "Surprise", " ", "at", " ", "T1", " ", "with", " ", "new", " ", 
         "value", " ", "for", " ", "\[Beta]"}], " ", "\[Rule]", " ", 
        RowBox[{"z", " ", "\[Beta]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"ns1", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "results1", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", "results1", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], "]"}], "]"}], 
        "[", "T1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ni1", "=", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Interpolation", "[", 
          RowBox[{"Transpose", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "results1", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", "results1", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "]"}], "]"}], "]"}], 
        "[", "T1", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"A", "=", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Interpolation", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "results1", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"Transpose", "[", "results1", "]"}], "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], "}"}], "]"}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"temp", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"ns", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"-", "z"}], " ", "\[Beta]", " ", 
              SuperscriptBox[
               RowBox[{"A", "[", "t", "]"}], "2"], 
              RowBox[{"ns", "[", "t", "]"}], " ", 
              RowBox[{"ni", "[", "t", "]"}]}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"ni", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{"z", " ", "\[Beta]", " ", 
               SuperscriptBox[
                RowBox[{"A", "[", "t", "]"}], "2"], 
               RowBox[{"ns", "[", "t", "]"}], " ", 
               RowBox[{"ni", "[", "t", "]"}]}], "-", 
              RowBox[{"\[Gamma]", " ", 
               RowBox[{"ni", "[", "t", "]"}]}]}]}], ",", 
            RowBox[{
             RowBox[{"ns", "[", "T1", "]"}], "\[Equal]", "ns1"}], ",", 
            RowBox[{
             RowBox[{"ni", "[", "T1", "]"}], "\[Equal]", "ni1"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"ns", ",", "ni"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "T1", ",", 
            RowBox[{"T1", "+", "T2"}]}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"results2", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", 
            RowBox[{"ns", "[", "t", "]"}], ",", 
            RowBox[{"ni", "[", "t", "]"}], ",", 
            RowBox[{"328000000", " ", "0.0062", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"ns", "[", "t", "]"}], "-", 
               RowBox[{"ni", "[", "t", "]"}]}], ")"}]}], ",", 
            RowBox[{"A", "[", "t", "]"}], ",", 
            RowBox[{"Log", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{"z", " ", "\[Beta]"}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"A", "[", "t", "]"}], "2"]}], "\[Gamma]"], "]"}], ",", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"z", " ", "\[Beta]"}], ")"}], " ", 
              SuperscriptBox[
               RowBox[{"A", "[", "t", "]"}], "2"], " ", 
              RowBox[{"ns", "[", "t", "]"}]}], "\[Gamma]"], ",", 
            RowBox[{"fx", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], " ", "t"}], 
              "]"}], " ", "\[Gamma]", " ", "\[Kappa]", " ", 
             RowBox[{"ni", "[", "t", "]"}]}], ",", 
            RowBox[{"fx", " ", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], " ", "t"}], 
              "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Gamma]", " ", "\[Kappa]", " ", 
                RowBox[{"ni", "[", "t", "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ns", "[", "t", "]"}], "+", 
                  RowBox[{"ni", "[", "t", "]"}]}], ")"}], " ", 
                RowBox[{"u", "[", 
                 RowBox[{"A", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], "}"}], "/.",
           "\[VeryThinSpace]", "temp"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "T1", ",", 
           RowBox[{"T1", "+", "T2"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Learn", " ", "about", " ", "this", " ", "at", " ", "T1"}], 
        "+", "T2"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"solution", "[", 
       RowBox[{"\[Alpha]", ",", 
        RowBox[{"z", " ", "\[Beta]"}], ",", "\[Gamma]", ",", "\[Delta]", ",", 
        "\[Rho]", ",", "\[Kappa]", ",", 
        RowBox[{"results2", "\[LeftDoubleBracket]", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "3"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"FX", "\[Rule]", "fx"}], ",", 
        RowBox[{"Ns0", "\[Rule]", 
         RowBox[{"results2", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "2"}], "\[RightDoubleBracket]"}]}], ",", 
        RowBox[{"Silent", "\[Rule]", "True"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"results3", "=", 
       RowBox[{"Drop", "[", 
        RowBox[{
         RowBox[{"N", "[", 
          RowBox[{"Take", "[", 
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}], "+", "T1", "+", 
                    "T2"}], ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"328000000", " ", "0.0062", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"ns", "[", "t", "]"}], "-", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}]}], ",", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", 
                    RowBox[{"z", " ", "\[Beta]"}], ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], ",", 
                    RowBox[{"Log", "[", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"z", " ", "\[Beta]"}], "\[Gamma]"], " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", 
                    RowBox[{"z", " ", "\[Beta]"}], ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"]}], 
                    "]"}], ",", 
                    RowBox[{
                    FractionBox[
                    RowBox[{"z", " ", "\[Beta]"}], "\[Gamma]"], " ", 
                    SuperscriptBox[
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", 
                    RowBox[{"z", " ", "\[Beta]"}], ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "2"], 
                    RowBox[{"ns", "[", "t", "]"}]}], ",", 
                    RowBox[{"fx", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ")"}]}], "]"}], 
                    "\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"fx", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"\[Delta]", "+", "\[Rho]"}], ")"}]}], 
                    RowBox[{"(", 
                    RowBox[{"t", "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}], ")"}]}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Gamma]", " ", "\[Kappa]", " ", 
                    RowBox[{"ni", "[", "t", "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ns", "[", "t", "]"}], "+", 
                    RowBox[{"ni", "[", "t", "]"}]}], ")"}], 
                    RowBox[{"u", "[", 
                    RowBox[{"a", "[", 
                    RowBox[{"\[Alpha]", ",", 
                    RowBox[{"z", " ", "\[Beta]"}], ",", 
                    RowBox[{"ns", "[", "t", "]"}], ",", 
                    RowBox[{"ni", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]s", "[", "t", "]"}], ",", 
                    RowBox[{"\[Lambda]i", "[", "t", "]"}]}], "]"}], "]"}]}]}],
                     ")"}]}]}], "}"}], "/.", 
                    RowBox[{"sol", "[", "n", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"t", ",", 
                    RowBox[{"T", "[", 
                    RowBox[{"n", "+", "1"}], "]"}], ",", 
                    RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"T", "[", "n", "]"}], ",", 
                    RowBox[{
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}], "+", 
                    RowBox[{"4", " ", "730"}]}]}], "]"}]}], "}"}]}], "]"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "steps", ",", 
                   RowBox[{
                    RowBox[{"Floor", "[", "x", "]"}], "/.", 
                    RowBox[{"FindRoot", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Interpolation", "[", 
                    RowBox[{
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{
                    RowBox[{"T", "[", "n", "]"}], "-", 
                    RowBox[{"T", "[", 
                    RowBox[{"steps", "+", "1"}], "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"steps", "+", "1"}], ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
                    RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}], 
                    "[", "x", "]"}], "\[Equal]", 
                    RowBox[{"2", " ", "730"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "steps"}], "}"}]}], "]"}]}], ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], ",", "9"}], 
             "]"}], ",", 
            RowBox[{"740", "-", 
             RowBox[{"(", 
              RowBox[{"T1", "+", "T2"}], ")"}]}]}], "]"}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"results", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"results1", ",", "T1"}], "]"}], ",", "results2", ",", 
          "results3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<Export\>\"", "]"}], "\[NotEqual]", 
         "\"\<False\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"StringJoin", "[", 
            RowBox[{"\"\<Shock\>\"", ",", "\"\<_alpha\>\"", ",", 
             RowBox[{"ToString", "[", "\[Alpha]", "]"}], ",", 
             "\"\<_gamma\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", 
               RowBox[{"\[Gamma]", ",", "3"}], "]"}], "]"}], ",", 
             "\"\<_beta\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", 
               RowBox[{"\[Beta]", ",", "3"}], "]"}], "]"}], ",", 
             "\"\<_kappa\>\"", ",", 
             RowBox[{"ToString", "[", "\[Kappa]", "]"}], ",", 
             "\"\<_delta\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"N", "[", 
               RowBox[{"\[Delta]", ",", "3"}], "]"}], "]"}], ",", 
             "\"\<_Ni\>\"", ",", 
             RowBox[{"ToString", "[", 
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"N", "[", "ni0", "]"}], ",", 
                RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], "]"}], 
             ",", "\"\<_T1\>\"", ",", 
             RowBox[{"ToString", "[", "T1", "]"}], ",", "\"\<_T2\>\"", ",", 
             RowBox[{"ToString", "[", "T2", "]"}], ",", "\"\<_z\>\"", ",", 
             RowBox[{"ToString", "[", "z", "]"}], ",", "\"\<.dat\>\""}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"N", "[", 
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"results", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"4", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "9"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"5", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"6", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"7", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"8", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"results", "[", 
                    RowBox[{"[", 
                    RowBox[{"9", ",", "i"}], "]"}], "]"}], ",", 
                    RowBox[{"ScientificNotationThreshold", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "8"}], ",", "6"}], "}"}]}]}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"Transpose", "[", "results", "]"}], "]"}]}], 
                    "}"}]}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
               "t", ",", "Ns", ",", "Ni", ",", "\"\<Dead_pi_0.0062\>\"", ",", 
                "\"\<A\>\"", ",", "LogRS", ",", "Rt", ",", "DiscHealthCost", 
                ",", "DiscTotalCost"}], "}"}]}], "]"}], "]"}]}], "]"}], 
         "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8227539884799476`*^9, 3.8227541093426723`*^9}, {
   3.822754261713735*^9, 3.822754386283358*^9}, 3.8227545611571136`*^9, {
   3.8227546280427766`*^9, 3.8227546281537113`*^9}, {3.822754664882691*^9, 
   3.822754666263872*^9}, {3.8227567674491067`*^9, 3.822756787983356*^9}, {
   3.8227568205656643`*^9, 3.822756840752096*^9}, {3.8227570545075827`*^9, 
   3.822757056164632*^9}, {3.822757209174286*^9, 3.822757297039955*^9}, {
   3.8227573509260445`*^9, 3.822757353577527*^9}, {3.8227574679443426`*^9, 
   3.822757473446191*^9}, {3.8227577171020374`*^9, 3.8227577799310055`*^9}, {
   3.8227579024812765`*^9, 3.8227579196884136`*^9}, {3.823006651678792*^9, 
   3.823006677087709*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"59512f52-71ad-480e-ad01-144742c6c66d"]
}, Open  ]]
},
WindowSize->{1141.2, 574.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"f12b2eeb-f955-4b35-9edc-ba30c7bed61f"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 609, 11, 28, "Input",ExpressionUUID->"a110e90a-254c-4db9-8957-43d906283d74"],
Cell[CellGroupData[{
Cell[1192, 35, 173, 3, 45, "Subsubsection",ExpressionUUID->"00873515-0fde-49f2-b8c4-c0e084765f5a"],
Cell[CellGroupData[{
Cell[1390, 42, 1363, 23, 45, "Input",ExpressionUUID->"044e4977-fb8b-4062-9d16-a761e7b2415c"],
Cell[CellGroupData[{
Cell[2778, 69, 746, 12, 22, "Print",ExpressionUUID->"eac7bbc9-84f7-4d91-bb95-23005881c1c8"],
Cell[3527, 83, 741, 12, 22, "Print",ExpressionUUID->"8500d305-5977-4b5e-a2ec-f4fe897aa5ca"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4329, 102, 215, 4, 45, "Subsubsection",ExpressionUUID->"3dab064e-8cc9-4b10-b971-d809a3865e02"],
Cell[4547, 108, 1132, 24, 35, "Text",ExpressionUUID->"d58cc137-4b6e-4892-b703-0003c883b322"],
Cell[5682, 134, 657, 17, 45, "Input",ExpressionUUID->"90b8af57-805f-4dd1-9a38-11f097ab252e"],
Cell[CellGroupData[{
Cell[6364, 155, 490, 10, 28, "Input",ExpressionUUID->"bfbcf700-2b87-4f5d-b147-6388d8a06aa8"],
Cell[CellGroupData[{
Cell[6879, 169, 362, 7, 22, "Print",ExpressionUUID->"7ccf532b-07ec-4128-9889-50cfadae8526"],
Cell[7244, 178, 300, 6, 22, "Print",ExpressionUUID->"4c844d5f-1512-4e15-a5e7-2b24e92050e1"],
Cell[7547, 186, 301, 6, 22, "Print",ExpressionUUID->"56661554-f734-453d-bd8a-9bf5a29a325d"],
Cell[7851, 194, 301, 6, 22, "Print",ExpressionUUID->"58f2982f-5d98-40ae-9b0d-a259e6524bb8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8201, 206, 445, 9, 28, "Input",ExpressionUUID->"89e1f019-6f13-48ae-a92c-bef431070cc5"],
Cell[CellGroupData[{
Cell[8671, 219, 281, 5, 22, "Print",ExpressionUUID->"c673e145-bc98-487b-97df-01337e5d4294"],
Cell[8955, 226, 219, 4, 22, "Print",ExpressionUUID->"a8a79808-0a29-4b14-b1fc-28cb005a16dd"],
Cell[9177, 232, 221, 4, 22, "Print",ExpressionUUID->"c1c8cc46-8505-42e4-958f-4108fdb6d2c8"],
Cell[9401, 238, 221, 4, 22, "Print",ExpressionUUID->"f0c2609b-d297-444b-a838-594ccedec281"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9671, 248, 421, 8, 28, "Input",ExpressionUUID->"9e281195-ff26-47aa-b047-fc2ba4d1c628"],
Cell[CellGroupData[{
Cell[10117, 260, 263, 5, 22, "Print",ExpressionUUID->"1afdce80-a85e-45e6-8b7e-9f649855aa9f"],
Cell[10383, 267, 200, 4, 22, "Print",ExpressionUUID->"5916c168-37fe-4e28-85c4-502c9b245011"],
Cell[10586, 273, 199, 4, 22, "Print",ExpressionUUID->"be83adcc-865c-46a6-a4c5-0c45ac6dd6d8"],
Cell[10788, 279, 200, 4, 22, "Print",ExpressionUUID->"74da0d6d-c3c1-453c-82b2-d4d2ac906c24"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11037, 289, 479, 9, 28, "Input",ExpressionUUID->"1135963b-5369-41a9-9ec2-aec6704b2004"],
Cell[11519, 300, 474, 11, 28, "Message",ExpressionUUID->"38b6e2d5-e24f-401d-8876-773f84495269"],
Cell[11996, 313, 475, 11, 28, "Message",ExpressionUUID->"62d6ed22-2d10-4897-aa40-958ba2f8f4ad"],
Cell[12474, 326, 475, 11, 28, "Message",ExpressionUUID->"19d760fa-015e-4db0-8e55-574687b8bf50"],
Cell[12952, 339, 453, 10, 28, "Message",ExpressionUUID->"f4fd442b-6bcd-413c-bb85-3e86417ec3a0"],
Cell[CellGroupData[{
Cell[13430, 353, 263, 5, 22, "Print",ExpressionUUID->"8f2b5b59-edd2-4b9d-962f-b4b7489dcaac"],
Cell[13696, 360, 200, 4, 22, "Print",ExpressionUUID->"54faf1a9-9e90-4ad7-87b6-d10c601b6510"],
Cell[13899, 366, 200, 4, 22, "Print",ExpressionUUID->"cfeea2c7-18e6-4bcf-89cf-d8bd82760d99"],
Cell[14102, 372, 198, 4, 22, "Print",ExpressionUUID->"5125a3a9-9a6f-4e33-ac7a-0c436c13dee4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14349, 382, 455, 9, 28, "Input",ExpressionUUID->"ff881c31-b6f1-46dd-b50c-3031b0f7b899"],
Cell[14807, 393, 446, 10, 39, "Message",ExpressionUUID->"ab498f2f-a3da-48df-ab90-829bfe6de134"],
Cell[15256, 405, 444, 10, 39, "Message",ExpressionUUID->"143f95a8-04b4-4617-9187-971e402223b6"],
Cell[15703, 417, 446, 10, 39, "Message",ExpressionUUID->"83daa998-f3fb-4d5f-a05e-b8b04555d8b2"],
Cell[16152, 429, 454, 10, 28, "Message",ExpressionUUID->"55aead1c-afbc-4aae-a43d-c20d21cbac4e"],
Cell[16609, 441, 2343, 36, 91, "Message",ExpressionUUID->"ea261ec9-ffab-4d6e-acf6-bd46ce5bf5f9"],
Cell[18955, 479, 2341, 36, 91, "Message",ExpressionUUID->"75fb44a7-2c70-4701-99d3-f5674c7e2c99"],
Cell[21299, 517, 2347, 36, 91, "Message",ExpressionUUID->"b0a689f1-227c-4af1-82ea-41130ebbaf51"],
Cell[23649, 555, 455, 10, 28, "Message",ExpressionUUID->"dedcfd27-f66b-476e-8cb0-61d34603fcab"],
Cell[24107, 567, 473, 11, 28, "Message",ExpressionUUID->"0bdfe3d8-e093-4ba0-bab2-77d12004130e"],
Cell[24583, 580, 449, 10, 28, "Message",ExpressionUUID->"f82f1597-3858-4956-afa2-ff35812b857b"],
Cell[25035, 592, 467, 10, 28, "Message",ExpressionUUID->"b06d3021-7f32-49b6-ada7-c472ce760dd0"],
Cell[25505, 604, 455, 10, 28, "Message",ExpressionUUID->"1dffa416-d04e-420b-a076-35d0c43fd1a8"],
Cell[25963, 616, 474, 11, 28, "Message",ExpressionUUID->"9cf82ade-8d96-4e37-99f5-f8eea087d639"],
Cell[26440, 629, 452, 10, 28, "Message",ExpressionUUID->"90ac620b-c22a-4d34-af75-02d14fab915a"],
Cell[26895, 641, 453, 10, 28, "Message",ExpressionUUID->"e56aafdf-e4e5-4d09-a173-d414de72ce31"],
Cell[27351, 653, 454, 10, 28, "Message",ExpressionUUID->"6032f2da-b4d0-4e40-b05a-13b06dad1b33"],
Cell[CellGroupData[{
Cell[27830, 667, 261, 5, 22, "Print",ExpressionUUID->"e796c820-da15-4482-884d-fdd4cbe6846d"],
Cell[28094, 674, 199, 4, 22, "Print",ExpressionUUID->"c5f7532d-9468-41b3-b158-4178c893f670"],
Cell[28296, 680, 202, 4, 22, "Print",ExpressionUUID->"c98f9a8b-f718-4e7a-ac08-3aabac928012"],
Cell[28501, 686, 197, 4, 22, "Print",ExpressionUUID->"0aa9728e-039b-4e08-b2ad-e7899daf5667"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28747, 696, 565, 10, 28, "Input",ExpressionUUID->"3e283dc0-d862-4b3f-9450-91971f1bec80"],
Cell[CellGroupData[{
Cell[29337, 710, 353, 6, 22, "Print",ExpressionUUID->"a2ae016a-cbea-4479-9a36-9937535e422c"],
Cell[29693, 718, 293, 5, 22, "Print",ExpressionUUID->"fedec983-12a7-41ea-aec9-77f3e222225c"],
Cell[29989, 725, 294, 5, 22, "Print",ExpressionUUID->"7050a73c-7fb9-42b4-bdeb-1c6d9ffc0933"],
Cell[30286, 732, 292, 5, 22, "Print",ExpressionUUID->"ba4b871e-c43f-4e3c-b947-2c5f762171a1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30627, 743, 565, 10, 28, "Input",ExpressionUUID->"ad4525af-6eb5-4edd-8666-31fdb15aa6f2"],
Cell[CellGroupData[{
Cell[31217, 757, 331, 6, 22, "Print",ExpressionUUID->"c44dc0ad-9507-400b-9c3e-f46c63f4d521"],
Cell[31551, 765, 269, 5, 22, "Print",ExpressionUUID->"7e7b31a1-5cba-40ae-ac3c-7fff26a61e1a"],
Cell[31823, 772, 273, 5, 22, "Print",ExpressionUUID->"710c75df-64d8-4a16-8296-eb7859641992"],
Cell[32099, 779, 268, 5, 22, "Print",ExpressionUUID->"326810e0-d30b-4a01-b197-78ae624a55da"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32416, 790, 642, 13, 45, "Input",ExpressionUUID->"0c2e0dc5-8429-4d0d-acb6-28ce68166b3b"],
Cell[33061, 805, 512, 11, 28, "Message",ExpressionUUID->"47f51b04-e8bf-4225-9e23-38ea416ebca5"],
Cell[33576, 818, 515, 11, 28, "Message",ExpressionUUID->"eacfb06f-7178-4803-b8f9-f1629970aff6"],
Cell[34094, 831, 513, 11, 28, "Message",ExpressionUUID->"b77442c6-4231-4580-983f-1a4c61f6a8d3"],
Cell[34610, 844, 500, 11, 28, "Message",ExpressionUUID->"0fba1919-eba5-4437-b304-0dda76d96c16"],
Cell[CellGroupData[{
Cell[35135, 859, 380, 7, 22, "Print",ExpressionUUID->"7d2e17d2-ce05-41dd-b91d-27d704049f4b"],
Cell[35518, 868, 319, 6, 22, "Print",ExpressionUUID->"7ae769cd-8de8-441f-a516-aae0fe7a527b"],
Cell[35840, 876, 322, 6, 22, "Print",ExpressionUUID->"dc27c004-4a3b-440f-adbe-8b30005d23ca"],
Cell[36165, 884, 320, 6, 22, "Print",ExpressionUUID->"3eb2f990-2624-4247-8c03-7b81527e0adf"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[36534, 896, 626, 13, 45, "Input",ExpressionUUID->"4a324742-b532-4af7-bc84-03b92c179454"],
Cell[CellGroupData[{
Cell[37185, 913, 355, 6, 22, "Print",ExpressionUUID->"1d9b3866-7c49-4715-a464-b6e58c98069f"],
Cell[37543, 921, 295, 5, 22, "Print",ExpressionUUID->"9734b6e9-78c8-4668-a55d-8d285d4c9224"],
Cell[37841, 928, 297, 5, 22, "Print",ExpressionUUID->"a0be62c4-8d05-48dc-bee7-e0c0857d85ad"],
Cell[38141, 935, 295, 5, 22, "Print",ExpressionUUID->"fb64ba7b-4042-4e7b-a1ea-f504c54ad490"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[38485, 946, 534, 10, 45, "Input",ExpressionUUID->"38a24ca0-7313-4072-86d4-9f1c4a80abac"],
Cell[CellGroupData[{
Cell[39044, 960, 332, 6, 22, "Print",ExpressionUUID->"2b781160-fa0e-483d-b146-2ac613640ec3"],
Cell[39379, 968, 272, 5, 22, "Print",ExpressionUUID->"5e432195-90ff-4083-b144-40479d101676"],
Cell[39654, 975, 271, 5, 22, "Print",ExpressionUUID->"bdc3665d-e86a-4776-afaa-72f26584a919"],
Cell[39928, 982, 269, 5, 22, "Print",ExpressionUUID->"f273c743-2110-4f6f-84f6-3aea1014a415"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40246, 993, 509, 9, 45, "Input",ExpressionUUID->"8049e2cb-2d70-4fbb-929d-1def797f80ac"],
Cell[CellGroupData[{
Cell[40780, 1006, 306, 6, 22, "Print",ExpressionUUID->"1f2ea569-be87-4b3f-bfc8-5bf3f1775614"],
Cell[41089, 1014, 247, 5, 22, "Print",ExpressionUUID->"8f595c67-df56-443b-b234-ea754530a754"],
Cell[41339, 1021, 247, 5, 22, "Print",ExpressionUUID->"cda87316-fdac-48f9-841e-2ca7d66f8712"],
Cell[41589, 1028, 245, 5, 22, "Print",ExpressionUUID->"30ff2ecb-fbde-4b74-9221-53649f62f655"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41883, 1039, 384, 8, 28, "Input",ExpressionUUID->"6e449b45-9448-4911-8ed0-e9c732be08ae"],
Cell[CellGroupData[{
Cell[42292, 1051, 250, 5, 22, "Print",ExpressionUUID->"dcfbc948-2833-4a83-8f3f-abae91f4393f"],
Cell[42545, 1058, 199, 4, 22, "Print",ExpressionUUID->"7fbdbd08-620b-4c3b-a5ee-4e7bd871425a"],
Cell[42747, 1064, 202, 4, 22, "Print",ExpressionUUID->"fde236d2-6cfc-45cf-93db-12fa33aef990"],
Cell[42952, 1070, 200, 4, 22, "Print",ExpressionUUID->"3ffd2038-e0d9-49ff-b73c-2770ccd69639"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43201, 1080, 384, 8, 28, "Input",ExpressionUUID->"2bdf40ea-14b1-4d1e-bdce-45db7207b537"],
Cell[CellGroupData[{
Cell[43610, 1092, 250, 5, 22, "Print",ExpressionUUID->"bce01bb1-157f-41de-9c9d-706907c189be"],
Cell[43863, 1099, 201, 4, 22, "Print",ExpressionUUID->"a460bf64-78b6-43da-9afb-5b2ee45c4e41"],
Cell[44067, 1105, 199, 4, 22, "Print",ExpressionUUID->"396fa945-0956-419b-a1e5-1171f4f625f7"],
Cell[44269, 1111, 198, 4, 22, "Print",ExpressionUUID->"81d715ff-f1eb-412b-adbb-3dc2d296a46c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44516, 1121, 520, 10, 28, "Input",ExpressionUUID->"e02c42a8-3203-4c09-a2db-bcb6b259f104"],
Cell[CellGroupData[{
Cell[45061, 1135, 325, 6, 22, "Print",ExpressionUUID->"584e0ddc-230f-44fe-92f1-e9d092415263"],
Cell[45389, 1143, 272, 5, 22, "Print",ExpressionUUID->"6293615f-9ec9-48cf-ad9f-3a4474c4d328"],
Cell[45664, 1150, 273, 5, 22, "Print",ExpressionUUID->"42f9bf93-c260-4f6f-ab0f-8874c87d6bbc"],
Cell[45940, 1157, 268, 5, 22, "Print",ExpressionUUID->"3d7c91e2-23c9-4894-885d-7f0f883a7d99"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46257, 1168, 494, 9, 28, "Input",ExpressionUUID->"da89bc2a-30a4-4526-b27c-6158243bfba9"],
Cell[CellGroupData[{
Cell[46776, 1181, 303, 6, 22, "Print",ExpressionUUID->"abe8b99f-28d1-420b-8194-d86349daf0a1"],
Cell[47082, 1189, 245, 5, 22, "Print",ExpressionUUID->"6c87e416-d10d-48c6-941a-bbd97b1beac8"],
Cell[47330, 1196, 247, 5, 22, "Print",ExpressionUUID->"e1d2dfff-7200-492e-af9b-d06ace3cccae"],
Cell[47580, 1203, 246, 5, 22, "Print",ExpressionUUID->"32234931-91b2-4963-90b7-095f0ccd28a4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47875, 1214, 703, 12, 28, "Input",ExpressionUUID->"ad26dd2d-4b91-4382-b36f-cdfb9f135797"],
Cell[48581, 1228, 862, 16, 28, "Message",ExpressionUUID->"cc77435d-7af1-4a98-a9eb-947f6970e39d"],
Cell[49446, 1246, 275, 5, 22, "Print",ExpressionUUID->"75158a0b-3c65-4a4b-9368-81a88f75f4c0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49758, 1256, 556, 10, 28, "Input",ExpressionUUID->"e7231f87-b7e0-4a37-85cb-3b79b6258ed4"],
Cell[50317, 1268, 299, 5, 22, "Print",ExpressionUUID->"179855c5-3a60-4ace-b4f4-a00dfa73fe26"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[50665, 1279, 167, 3, 45, "Subsubsection",ExpressionUUID->"54a05d4d-b26c-4b1b-9d87-f9c5086b81a8"],
Cell[50835, 1284, 10622, 243, 561, "Input",ExpressionUUID->"b021ac75-16dd-4471-aa79-0a9ef3e9c423",
 InitializationCell->True],
Cell[61460, 1529, 1152, 25, 64, "Input",ExpressionUUID->"d58956c9-7c1f-495d-a317-9509518a0659",
 InitializationCell->True],
Cell[62615, 1556, 153, 3, 28, "Input",ExpressionUUID->"80622ed9-4e92-4341-ad8e-678f481e1df9"],
Cell[62771, 1561, 4450, 65, 64, "Input",ExpressionUUID->"9f274614-58be-48d7-8890-49eeeb7d2465",
 InitializationCell->True],
Cell[67224, 1628, 56181, 1225, 2915, "Input",ExpressionUUID->"c4253f65-2879-4612-9f5f-01ee2c6e8bcf",
 InitializationCell->True],
Cell[123408, 2855, 31278, 695, 1458, "Input",ExpressionUUID->"59512f52-71ad-480e-ad01-144742c6c66d",
 InitializationCell->True]
}, Open  ]]
}
]
*)

